!function(t){function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}var e={};n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=521)}({100:function(t,n,e){"use strict";function o(){tinymce.init({menubar:!1,selector:"textarea",forced_root_block:!1,plugins:["advlist autolink link image lists charmap print preview hr anchor pagebreak spellchecker","searchreplace visualblocks visualchars codesample fullscreen insertdatetime media nonbreaking","save table contextmenu directionality emoticons template paste textcolor"],toolbar:["styleselect | bold italic codesample | link image | bullist numlist outdent indent | forecolor backcolor"],paste_as_text:!0,branding:!1,width:"calc(100% - 2px)",setup:function(t){t.on("change",function(){t.save()})}}),$(document).on("focusin",function(t){$(t.target).closest(".mce-window").length&&t.stopImmediatePropagation()})}Object.defineProperty(n,"__esModule",{value:!0}),n.tinymceInit=o},16:function(t,n,e){"use strict";function o(t,n){var e=t+"?";for(var o in n)e=e+o+"="+n[o]+"&";return e}function a(t){var n=null;if(document.cookie&&""!=document.cookie)for(var e=document.cookie.split(";"),o=0;o<e.length;o++){var a=e[o].trim();if(a.substring(0,t.length+1)==t+"="){n=decodeURIComponent(a.substring(t.length+1));break}}return n}function i(t,n){var e=setInterval(function(){t.complete&&(n(t),clearInterval(e))},8)}function r(t){var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,function(t,n,e,o){return n+n+e+e+o+o});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function l(t,n){return"/coteries/"+n+"/documents/"+t.title.replace(/\s/g,"-")+"/"+t.pk}function c(t){return"/documents/"+t.title.replace(/\s/g,"-")+"/"+t.pk}Object.defineProperty(n,"__esModule",{value:!0}),n.getCookie=a,n.getUrlFormat=o,n.imgLoad=i,n.hexToRgb=r,n.formatOpenCoterieDocumentUrl=l,n.formatOpenDocumentUrl=c},521:function(t,n,e){"use strict";function o(t){$(".AnnotationDiv[annotation_id='"+t+"']").remove(),$(".Annotation[annotation_id='"+t+"']").remove()}function a(t){for(var n=$(".AnnotationReplyBlock[annotation_reply_id='"+t+"']").toArray();n.length>0;){var e=$(n.shift()),o=e.attr("annotation_reply_id");n=n.concat($(".AnnotationReplyBlock[reply_to_annotation_reply='"+o+"']").toArray()),e.remove()}}function i(){$("code").addClass("prettyprint"),PR.prettyPrint(),$(".AnnotationBlock").on("mouseover",function(){var t=$(this).attr("annotation_id"),n=$(".Annotation[annotation_id='"+t+"']");$(this).css("box-shadow","2px 3px 8px rgba(0, 0, 0, .25)"),n.css("box-shadow","2px 3px 8px rgba(0, 0, 0, .25)")}),$(".AnnotationBlock").on("mouseout",function(){var t=$(this).attr("annotation_id"),n=$(".Annotation[annotation_id='"+t+"']");$(this).css("box-shadow","none"),n.css("box-shadow","none")}),$(".AnnotationBlock").on("click",function(){var t=$(this).attr("annotation_id"),n=$(".Annotation[annotation_id='"+t+"']"),e=$("#file_viewer"),o=n.offset().top-e.offset().top+e.scrollTop()-.38*window.innerHeight+n.height()/2;e.animate({scrollTop:parseInt(o)},240)}),$(".PostReplyReplyButton").on("click",function(){if(is_authenticated){var t=!this.classList.contains("AnonymouslyPostReplyReplyButton"),n=$(this),e=layer.load(1,{shade:.18});$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,r.getCookie)("csrftoken"),operation:"reply_annotation",annotation_reply_content:n.parents("form").find("textarea[name='reply_reply_content']").val(),reply_to_annotation_id:n.parents(".AnnotationBlock").find(".PostAnnotationReplyButton").val(),reply_to_annotation_reply_id:n.val(),document_id:$("button[name='document_id']").val(),is_public:t},success:function(t){$("#annotation_update_div").html(t),i(),(0,l.tinymceInit)(),layer.close(e)}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),$(".DeleteAnnotationReplyButton").on("click",function(){var t=layer.load(1,{shade:.18}),n=this.value;$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,r.getCookie)("csrftoken"),operation:"delete_annotation_reply",reply_id:n,document_id:$("button[name='document_id']").val()},success:function(e){a(n),layer.close(t)}})}),$(".PostAnnotationReplyButton").on("click",function(){if(is_authenticated){var t=!this.classList.contains("AnonymouslyPostAnnotationReplyButton"),n=$(this),e=layer.load(1,{shade:.18});$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,r.getCookie)("csrftoken"),operation:"reply_annotation",annotation_reply_content:n.parent("form").find("textarea[name='annotation_reply_content']").val(),reply_to_annotation_id:n.val(),document_id:$("button[name='document_id']").val(),is_public:t},success:function(t){$("#annotation_update_div").html(t),i(),(0,l.tinymceInit)(),layer.close(e)}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),$(".DeleteAnnotationButton").on("click",function(){var t=layer.load(1,{shade:.18}),n=this.value;$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,r.getCookie)("csrftoken"),operation:"delete_annotation",annotation_id:this.value},success:function(){o(n),layer.close(t)}})}),$(".LikeAnnotationButton").on("click",function(){if(is_authenticated){var t=$(this),n=parseInt(t.next().text())+1;t.next().text(n.toString()),t.off("click"),t.css("color","#6495ED"),t.on("click",function(){layer.msg("already liked",{icon:6,time:800})}),$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,r.getCookie)("csrftoken"),operation:"like_annotation",annotation_id:t.attr("annotation_id")}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),$(".LikeAnnotationReplyButton").on("click",function(){if(is_authenticated){var t=$(this),n=parseInt(t.next().text())+1;t.next().text(n.toString()),t.off("click"),t.css("color","#6495ED"),t.on("click",function(){layer.msg("already liked",{icon:6,time:800})}),$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,r.getCookie)("csrftoken"),operation:"like_annotation_reply",annotation_reply_id:t.attr("annotation_reply_id")}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),$(".ReplyAnnotationButton").on("click",function(){$(this).parents("footer").children("form").slideToggle({duration:180,start:function(){$(this).is(":hidden")||$(".ReplyAnnotationButton").parents("footer").children("form").not($(this)).slideUp(180)}})})}Object.defineProperty(n,"__esModule",{value:!0}),n.addAnnotationRelatedListener=void 0;var r=e(16),l=e(100);n.addAnnotationRelatedListener=i}});