!function(t){var n={};function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)e.d(o,a,function(n){return t[n]}.bind(null,a));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=476)}({105:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tinymceInit=void 0;e(22);var o=function(t){return t&&t.__esModule?t:{default:t}}(e(37));n.tinymceInit=function(){tinymce.init({menubar:!1,selector:"textarea",plugins:["advlist autolink link image lists charmap print preview hr anchor pagebreak spellchecker","searchreplace visualblocks visualchars codesample fullscreen insertdatetime media nonbreaking","save table contextmenu directionality emoticons template paste textcolor"],toolbar:["styleselect | bold italic codesample | link image | bullist numlist outdent indent | forecolor | formula"],entity_encoding:"raw",indent:!1,paste_as_text:!0,branding:!1,width:"calc(100% - 2px)",default_link_target:"_blank",images_upload_handler:function(t,n,e){var a=t.filename(),i="."+a.split(".")[a.split(".").length-1];new File([t.blob()],function(t){for(var n="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",o=0;o<t;o++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}(16)+i),o.default.post("https://api.imgur.com/3/upload",{image:t.base64()},{headers:{Authorization:"Client-ID a1f3b6d766ac1cc"}}).then(function(t){n(t.data.data.link)})},setup:function(t){t.on("change",function(){t.save()}),t.addButton("formula",{text:"Formula",icon:!1,onclick:function(){t.insertContent("$$ write LATEX here $$")}})}}),$(document).on("focusin",function(t){$(t.target).closest(".mce-window").length&&t.stopImmediatePropagation()})}},106:function(t,n,e){"use strict";var o=e(13),a=e(53),i=e(108),r=e(43);function s(t){var n=new i(t),e=a(i.prototype.request,n);return o.extend(e,i.prototype,n),o.extend(e,n),e}var c=s(r);c.Axios=i,c.create=function(t){return s(o.merge(r,t))},c.Cancel=e(57),c.CancelToken=e(122),c.isCancel=e(56),c.all=function(t){return Promise.all(t)},c.spread=e(123),t.exports=c,t.exports.default=c},107:function(t,n){function e(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(e(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&e(t.slice(0,0))}(t)||!!t._isBuffer)}},108:function(t,n,e){"use strict";var o=e(43),a=e(13),i=e(117),r=e(118),s=e(120),c=e(121);function l(t){this.defaults=t,this.interceptors={request:new i,response:new i}}l.prototype.request=function(t){"string"==typeof t&&(t=a.merge({url:arguments[0]},arguments[1])),(t=a.merge(o,this.defaults,{method:"get"},t)).method=t.method.toLowerCase(),t.baseURL&&!s(t.url)&&(t.url=c(t.baseURL,t.url));var n=[r,void 0],e=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){n.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){n.push(t.fulfilled,t.rejected)});n.length;)e=e.then(n.shift(),n.shift());return e},a.forEach(["delete","get","head","options"],function(t){l.prototype[t]=function(n,e){return this.request(a.merge(e||{},{method:t,url:n}))}}),a.forEach(["post","put","patch"],function(t){l.prototype[t]=function(n,e,o){return this.request(a.merge(o||{},{method:t,url:n,data:e}))}}),t.exports=l},109:function(t,n,e){"use strict";var o=e(13);t.exports=function(t,n){o.forEach(t,function(e,o){o!==n&&o.toUpperCase()===n.toUpperCase()&&(t[n]=e,delete t[o])})}},110:function(t,n,e){"use strict";var o=e(55);t.exports=function(t,n,e){var a=e.config.validateStatus;e.status&&a&&!a(e.status)?n(o("Request failed with status code "+e.status,e.config,null,e.request,e)):t(e)}},111:function(t,n,e){"use strict";t.exports=function(t,n,e,o,a){return t.config=n,e&&(t.code=e),t.request=o,t.response=a,t}},112:function(t,n,e){"use strict";var o=e(13);function a(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,n,e){if(!n)return t;var i;if(e)i=e(n);else if(o.isURLSearchParams(n))i=n.toString();else{var r=[];o.forEach(n,function(t,n){null!==t&&void 0!==t&&(o.isArray(t)&&(n+="[]"),o.isArray(t)||(t=[t]),o.forEach(t,function(t){o.isDate(t)?t=t.toISOString():o.isObject(t)&&(t=JSON.stringify(t)),r.push(a(n)+"="+a(t))}))}),i=r.join("&")}return i&&(t+=(-1===t.indexOf("?")?"?":"&")+i),t}},113:function(t,n,e){"use strict";var o=e(13);t.exports=function(t){var n,e,a,i={};return t?(o.forEach(t.split("\n"),function(t){a=t.indexOf(":"),n=o.trim(t.substr(0,a)).toLowerCase(),e=o.trim(t.substr(a+1)),n&&(i[n]=i[n]?i[n]+", "+e:e)}),i):i}},114:function(t,n,e){"use strict";var o=e(13);t.exports=o.isStandardBrowserEnv()?function(){var t,n=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");function a(t){var o=t;return n&&(e.setAttribute("href",o),o=e.href),e.setAttribute("href",o),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return t=a(window.location.href),function(n){var e=o.isString(n)?a(n):n;return e.protocol===t.protocol&&e.host===t.host}}():function(){return!0}},115:function(t,n,e){"use strict";var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(){this.message="String contains an invalid character"}a.prototype=new Error,a.prototype.code=5,a.prototype.name="InvalidCharacterError",t.exports=function(t){for(var n,e,i=String(t),r="",s=0,c=o;i.charAt(0|s)||(c="=",s%1);r+=c.charAt(63&n>>8-s%1*8)){if((e=i.charCodeAt(s+=.75))>255)throw new a;n=n<<8|e}return r}},116:function(t,n,e){"use strict";var o=e(13);t.exports=o.isStandardBrowserEnv()?{write:function(t,n,e,a,i,r){var s=[];s.push(t+"="+encodeURIComponent(n)),o.isNumber(e)&&s.push("expires="+new Date(e).toGMTString()),o.isString(a)&&s.push("path="+a),o.isString(i)&&s.push("domain="+i),!0===r&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},117:function(t,n,e){"use strict";var o=e(13);function a(){this.handlers=[]}a.prototype.use=function(t,n){return this.handlers.push({fulfilled:t,rejected:n}),this.handlers.length-1},a.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},a.prototype.forEach=function(t){o.forEach(this.handlers,function(n){null!==n&&t(n)})},t.exports=a},118:function(t,n,e){"use strict";var o=e(13),a=e(119),i=e(56),r=e(43);function s(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return s(t),t.headers=t.headers||{},t.data=a(t.data,t.headers,t.transformRequest),t.headers=o.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(n){delete t.headers[n]}),(t.adapter||r.adapter)(t).then(function(n){return s(t),n.data=a(n.data,n.headers,t.transformResponse),n},function(n){return i(n)||(s(t),n&&n.response&&(n.response.data=a(n.response.data,n.response.headers,t.transformResponse))),Promise.reject(n)})}},119:function(t,n,e){"use strict";var o=e(13);t.exports=function(t,n,e){return o.forEach(e,function(e){t=e(t,n)}),t}},120:function(t,n,e){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},121:function(t,n,e){"use strict";t.exports=function(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t}},122:function(t,n,e){"use strict";var o=e(57);function a(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(t){n=t});var e=this;t(function(t){e.reason||(e.reason=new o(t),n(e.reason))})}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.source=function(){var t;return{token:new a(function(n){t=n}),cancel:t}},t.exports=a},123:function(t,n,e){"use strict";t.exports=function(t){return function(n){return t.apply(null,n)}}},13:function(t,n,e){"use strict";var o=e(53),a=e(107),i=Object.prototype.toString;function r(t){return"[object Array]"===i.call(t)}function s(t){return null!==t&&"object"==typeof t}function c(t){return"[object Function]"===i.call(t)}function l(t,n){if(null!==t&&void 0!==t)if("object"==typeof t||r(t)||(t=[t]),r(t))for(var e=0,o=t.length;e<o;e++)n.call(null,t[e],e,t);else for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&n.call(null,t[a],a,t)}t.exports={isArray:r,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:a,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:c,isStream:function(t){return s(t)&&c(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function t(){var n={};function e(e,o){"object"==typeof n[o]&&"object"==typeof e?n[o]=t(n[o],e):n[o]=e}for(var o=0,a=arguments.length;o<a;o++)l(arguments[o],e);return n},extend:function(t,n,e){return l(n,function(n,a){t[a]=e&&"function"==typeof n?o(n,e):n}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},22:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),String.prototype.format=function(){var t=this;for(var n in arguments)t=t.replace("{"+n+"}",arguments[n]);return t},n.groupAvatarColors=["#1BA39C","#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#f1c40f","#e67e22","#e74c3c"],n.getCookie=function(t){var n=null;if(document.cookie&&""!=document.cookie)for(var e=document.cookie.split(";"),o=0;o<e.length;o++){var a=e[o].trim();if(a.substring(0,t.length+1)==t+"="){n=decodeURIComponent(a.substring(t.length+1));break}}return n},n.copyToClipboard=function(t){var n=document.createElement("input");n.style.hidden=!0,document.body.appendChild(n),n.value=t,n.select(),document.execCommand("copy"),document.body.removeChild(n)},n.getUrlFormat=function(t,n){var e=t+"?";for(var o in n)e=e+o+"="+n[o]+"&";return e},n.hexToRgb=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,n,e,o){return n+n+e+e+o+o});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null},n.formatOpenCoterieDocumentUrl=function(t,n){return"/coteries/"+n+"/documents/"+t.slug+"/"+t.title.replace(/\s/g,"-")},n.formatOpenDocumentUrl=function(t){return"/documents/"+t.slug+"/"+t.title.replace(/\s/g,"-")},n.getValFromUrlParam=function(t){return new URL(window.location.href).searchParams.get(t)},n.renderMathJax=function(){window.hasOwnProperty("MathJax")&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])},n.range=function(t){return Array(t-0).fill().map(function(t,n){return 0+n})}},253:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getPageDividerJQ=n.findTargetAnnotation=n.scrollAnnotationIntoView=n.scrollAnnotationDivIntoView=n.addAnnotationRelatedListenerWithin=n.addAnnotationRelatedListener=void 0;var o=e(22),a=e(105);function i(t){return $('     <div class="PageDivider" page="'+t+'" style="height: 9px; border-bottom: 1px solid #eeeeee; margin: 18px 36px; text-align: center;">       <span style="font-size: 14px; background-color: white; padding: 0 30px; font-weight: 400; color: grey;">     Page '+t+"       </span>     </div>   ")}function r(t){var n=$('.AnnotationDiv[annotation_id="{0}"]'.format(t)).attr("page");if(function(t){var n='.AnnotationDiv[annotation_id="{0}"]'.format(t);return $(n)}(t).remove(),$('.Annotation[annotation_id="{0}"]'.format(t)).remove(),$('.AnnotationDiv[page="{0}"]'.format(n)).toArray().length>0){var e=$('.AnnotationDiv[page="{0}"]'.format(n)).first();void 0!=e.find("hr")[0]&&e.children("hr").replaceWith(i(n))}}function s(t){return parseFloat($(t).css("left"))}function c(t){return parseFloat($(t).css("left"))+$(t).width()}function l(t){return parseFloat($(t).css("top"))}function u(t){return parseFloat($(t).css("top"))+$(t).height()}function d(t){var n=$("#file_viewer"),e=t.offset().top-n.offset().top+n.scrollTop()-.38*window.innerHeight+t.height()/2;n.animate({scrollTop:parseInt(e)},240)}function f(t,n,e){var o=n.filter(function(n){return function(t,n,e){var o=n.pageX-e.offset().left,a=n.pageY-e.offset().top;return s(t)<=o&&c(t)>=o&&l(t)<=a&&u(t)>=a}(n,t,e)}),a=o.sort(function(t,n){return c(t)>c(n)});return c(a[1])-c(a[0])<9&&s((a=o.sort(function(t,n){return s(t)<s(n)}))[0])-s(a[1])<9&&u((a=o.sort(function(t,n){return u(t)>u(n)}))[1])-u(a[0])<9&&(a=o.sort(function(t,n){return l(t)<l(n)})),$(a[0])}function p(t){var n=window.location.pathname.split("/")[1];t.find("code").addClass("prettyprint"),PR.prettyPrint(),t.find(".AnnotationBlock").on({mouseover:function(){var t=$(this).attr("annotation_id"),n=$('.Annotation[annotation_id="{0}"]'.format(t));$(this).css("box-shadow","3px 3px 8px rgba(0, 0, 0, .38)"),n.css("box-shadow","3px 3px 8px rgba(0, 0, 0, .38)")},mouseout:function(){var t=$(this).attr("annotation_id"),n=$('.Annotation[annotation_id="{0}"]'.format(t));$(this).css("box-shadow","none"),n.css("box-shadow","none")}}),t.find(".AnnotationDirectButton").on("click",function(t){var n=$(this).parents(".AnnotationDiv").attr("annotation_id");d($('.Annotation[annotation_id="{0}"]'.format(n)))}),t.find(".PostReplyReplyButton").on("click",function(){if(is_authenticated){var t=!this.classList.contains("AnonymouslyPostReplyReplyButton"),n=$(this),e=layer.load(1,{shade:.18});$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"reply_annotation",annotation_reply_content:n.parents("form").find('textarea[name="reply_reply_content"]').val(),reply_to_annotation_id:n.parents(".AnnotationBlock").find(".PostAnnotationReplyButton").val(),reply_to_annotation_reply_id:n.val(),document_id:$('button[name="document_id"]').val(),is_public:t},success:function(t){var o=$(t.new_annotationreply_html);$('.AnnotationBlock[annotation_id="{0}"]'.format(n.parents(".AnnotationBlock").find(".PostAnnotationReplyButton").val())).append(o),$(".ReplyAnnotationButton").parents("footer").children("form").css("display","none"),tinyMCE.activeEditor.setContent(""),p(o),(0,a.tinymceInit)(),layer.close(e)}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),t.find(".DeleteAnnotationReplyButton").on("click",function(){var t=layer.load(1,{shade:.18}),n=this.value;$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"delete_annotation_reply",reply_id:n,document_id:$('button[name="document_id"]').val()},success:function(e){!function(t){for(var n=$('.annotation-reply-block[annotation_reply_id="{0}"]'.format(t)).toArray();n.length>0;){var e=$(n.shift()),o=e.attr("annotation_reply_id");n=n.concat($('.annotation-reply-block[reply_to_annotation_reply="{0}"]'.format(o)).toArray()),e.remove()}}(n),layer.close(t)}})}),t.find(".PostAnnotationReplyButton").on("click",function(){if(is_authenticated){var t=!this.classList.contains("AnonymouslyPostAnnotationReplyButton"),n=$(this),e=layer.load(1,{shade:.18});$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"reply_annotation",annotation_reply_content:n.parent("form").find('textarea[name="annotation_reply_content"]').val(),reply_to_annotation_id:n.val(),document_id:$('button[name="document_id"]').val(),is_public:t},success:function(t){var o=$(t.new_annotationreply_html);$('.AnnotationBlock[annotation_id="{0}"]'.format(n.val())).append(o),$(".ReplyAnnotationButton").parents("footer").children("form").css("display","none"),tinyMCE.activeEditor.setContent(""),p(o),(0,a.tinymceInit)(),layer.close(e)}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),t.find(".delete-annotation-btn").on("click",function(){var t=layer.load(1,{shade:.18}),n=this.value;$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"delete_annotation",annotation_id:this.value},success:function(){r(n),layer.close(t)}})}),t.find(".share-annotation-btn").on("click",function(){var t=$(this).parents(".AnnotationDiv").attr("annotation_uuid"),n=[location.protocol,"//",location.host,location.pathname].join("")+"?annotation="+t;layer.confirm('<span style="color: #37b">'+n+"<span>",{title:!1,skin:"layui-layer-molv",btn:["copy URL"],closeBtn:0,shade:.18,shadeClose:!0},function(){(0,o.copyToClipboard)(n),layer.msg("URL copied",{time:1228})})}),t.find(".like-annotation-btn").on("click",function(){if(is_authenticated){var t=$(this),n=parseInt(t.find(".num_like").text())+1;t.find(".num_like").text(n.toString()),t.off("click"),t.css("color","#6495ED"),t.on("click",function(){layer.msg("already liked",{icon:6,time:666})}),$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"like_annotation",annotation_id:t.attr("annotation_id")}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),t.find(".like-annotation-reply-btn").on("click",function(){if(is_authenticated){var t=$(this),n=parseInt(t.find(".num_like").text())+1;t.find(".num_like").text(n.toString()),t.off("click"),t.css("color","#6495ED"),t.on("click",function(){layer.msg("already liked",{icon:6,time:666})}),$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"like_annotation_reply",annotation_reply_id:t.attr("annotation_reply_id")}})}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),t.find(".ReplyAnnotationButton").on("click",function(){var t=$(this).parents("footer").children("form"),n=t[0],e="none"===!n.style.display;"none"===n.style.display?n.style.display="block":n.style.display="none",e||(tinyMCE.get(t.find("textarea").attr("id")).focus(),$(".ReplyAnnotationButton").parents("footer").children("form").not(t).css("display","none"))}),t.find(".EditFormToggleButton").on("click",function(){var t=$(this);t.parents(".AnnotationDiv").find(".AnnotationBlock").css("display","none"),t.parents(".AnnotationDiv").find(".AnnotationEditForm").fadeIn(666);var e=tinyMCE.get($(this).parents(".AnnotationDiv").find(".AnnotationEditForm").find("textarea").attr("id"));$.get({url:"/"+n+"/api/annotations/"+t.attr("annotation_id")+"/content",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken")},success:function(t){e.setContent(t),e.focus()}})}),t.find(".annotation-reply-edit-form-toggle-btn").on("click",function(){var t=$(this);t.parents(".annotation-reply-div").find(".annotation-reply-block").css("display","none"),t.parents(".annotation-reply-div").find(".annotation-reply-edit-form").fadeIn(666);var e=tinyMCE.get($(this).parents(".annotation-reply-div").find(".annotation-reply-edit-form").find("textarea").attr("id"));$.get({url:"/"+n+"/api/annotationreplies/"+t.attr("annotation_reply_id")+"/content",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken")},success:function(t){e.setContent(t),e.focus()}})}),t.find(".cancel-annotation-edit-btn").on("click",function(){var t=$(this).parents(".AnnotationDiv");t.find(".AnnotationBlock").css("display","block"),t.find(".AnnotationEditForm").css("display","none"),tinyMCE.get(t.find(".AnnotationEditForm").find("textarea").attr("id")).setContent("")}),t.find(".cancel-annotation-reply-edit-btn").on("click",function(){var t=$(this);t.parents(".annotation-reply-div").find(".annotation-reply-block").css("display","block"),t.parents(".annotation-reply-div").find(".annotation-reply-edit-form").css("display","none"),tinyMCE.get($(this).parents(".annotation-reply-div").find(".annotation-reply-edit-form").find("textarea").attr("id")).setContent("")}),t.find(".PostAnnotationEditButton").on("click",function(){var t=$(this),e=tinyMCE.get($(this).parents(".AnnotationDiv").find(".AnnotationEditForm").find("textarea").attr("id")),i=t.parents(".AnnotationEditForm").find('textarea[name="annotation_edit_content"]').val();$.post({url:"/"+n+"/api/annotations/"+t.attr("annotation_id")+"/edit",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),new_content:i},success:function(){var n=t.parents(".AnnotationDiv");n.find(".annotation-content").html(i),n.find(".annotation-time-span").text("edited"),n.find(".AnnotationEditForm").css("display","none"),n.find(".AnnotationBlock").fadeIn(666),n.find(".AnnotationBlock").css("display","block"),e.setContent(""),p(n),(0,a.tinymceInit)()}})}),t.find(".PostAnnotationReplyEditButton").on("click",function(){var t=$(this),e=tinyMCE.get($(this).parents(".annotation-reply-div").find(".annotation-reply-edit-form").find("textarea").attr("id")),i=t.parents(".annotation-reply-edit-form").find('textarea[name="annotation_reply_edit_content"]').val();$.post({url:"/"+n+"/api/annotationreplies/"+t.attr("annotation_reply_id")+"/edit",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),new_content:i},success:function(){var n=t.parents(".annotation-reply-div");n.find(".annotation-reply-content").html(i),n.find(".annotation-reply-time-span").text("edited"),n.find(".annotation-reply-edit-form").css("display","none"),n.find(".annotation-reply-block").fadeIn(666),n.find(".annotation-reply-block").css("display","block"),e.setContent(""),p(n),(0,a.tinymceInit)()}})}),t.find(".Annotation").addBack(".Annotation").on("mouseover",function(){var n=$(this).parent(".page_div").children(".PageCanvas"),e=$(this).parent(".page_div").find(".Annotation").toArray(),o=void 0;t.find(".Annotation").addBack(".Annotation").on("mousemove",function(t){if(0==t.which){var a=f(t,e,n);a!=o&&(void 0!=o&&(o.css("box-shadow","none"),$('.AnnotationBlock[annotation_id="{0}"]'.format($(o).attr("annotation_id"))).css("box-shadow","none")),a.css("box-shadow","3px 3px 8px rgba(0, 0, 0, .38)"),$('.AnnotationBlock[annotation_id="{0}"]'.format($(a).attr("annotation_id"))).css("box-shadow","3px 3px 8px rgba(0, 0, 0, .38)"),o=a)}else{var i=!0,r=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;$(u).css("box-shadow","none"),$('.AnnotationBlock[annotation_id="{0}"]'.format($(u).attr("annotation_id"))).css("box-shadow","none")}}catch(t){r=!0,s=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw s}}}})}),t.find(".Annotation").addBack(".Annotation").on("mouseout",function(t){if(0==t.which){var n=$(this).parent(".page_div").find(".Annotation").toArray(),e=!0,o=!1,a=void 0;try{for(var i,r=n[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var s=i.value;$(s).css("box-shadow","none"),$('.AnnotationBlock[annotation_id="{0}"]'.format($(s).attr("annotation_id"))).css("box-shadow","none"),$(s).off("mousemove")}}catch(t){o=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(o)throw a}}}}),t.find(".annotation-content img, .annotation-reply-content img").on("click",function(t){layer.photos({photos:{data:[{src:$(this).attr("src"),alt:void 0}]},shift:5,tab:function(t,n){$(".layui-layer-imgsee").find("em").remove(),$(".layui-layer-imgbar").remove()}})}),(0,o.renderMathJax)()}n.addAnnotationRelatedListener=function(){p($(document))},n.addAnnotationRelatedListenerWithin=p,n.scrollAnnotationDivIntoView=function(t){var n=$("#annotation-update-div"),e=t.offset().top-n.offset().top+n.scrollTop();n.animate({scrollTop:parseInt(e)},240)},n.scrollAnnotationIntoView=d,n.findTargetAnnotation=f,n.getPageDividerJQ=i},37:function(t,n,e){t.exports=e(106)},384:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.enablePostCommentButton=n.enableRefreshCommentButton=n.addCommentRelatedListener=void 0;var o=e(22),a=e(105);function i(){(0,a.tinymceInit)(),$("code").addClass("prettyprint"),PR.prettyPrint(),$(".likeCommentButton").on("click",function(){if(is_authenticated){var t=$(this),n=parseInt(t.next().text())+1;t.next().text(n.toString()),t.off("click"),t.css("color","#6495ED"),t.on("click",function(){layer.msg("already liked",{icon:6,time:800})}),$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"like_comment",comment_id:t.attr("comment_id")}})}else layer.msg('<span style="color: #ECECEC">You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first</span>')}),$(".delete_comment_button").on("click",function(){if(is_authenticated){var t=layer.load(0,{shade:.18}),n=this.value;$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"delete_comment",comment_id:n,document_id:$('button[name="document_id"]').val()},success:function(e){!function(t){for(var n=$('.CommentBlock[comment_id="{0}"]'.format(t)).toArray();n.length>0;){var e=$(n.shift()),o=e.attr("comment_id");n=n.concat($('.CommentBlock[reply_to_comment_id="{0}"]'.format(o)).toArray()),e.remove()}}(n),layer.close(t)}})}}),$(".reply_comment_button").on("click",function(){$(this).parents("blockquote").find(".reply_comment_form").slideToggle({duration:180,start:function(){$(this).is(":hidden")||$(".reply_comment_form").not($(this)).slideUp(180)}})}),$(".post_comment_reply_button").on("click",function(){if(is_authenticated){var t=!this.classList.contains("anonymously_post_comment_reply_button"),n=$(this),e=layer.load(0,{shade:.18});$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"comment",comment_content:n.parents("form").find('textarea[name="comment_content"]').val(),document_id:$('button[name="document_id"]').val(),reply_to_comment_id:n.val(),is_public:t},success:function(t){$("#comment_update_div").html(t),i(),layer.close(e)}})}else layer.msg('<span style="color: #ECECEC">You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first</span>')})}n.addCommentRelatedListener=i,n.enableRefreshCommentButton=function(){$("#refresh_comment_button").on("click",function(){$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"refresh",document_id:$('button[name="document_id"]').val()},success:function(t){$("#comment_update_div").html(t),i()}})})},n.enablePostCommentButton=function(){$(".post_comment_button").on("click",function(){if(is_authenticated){var t=!this.classList.contains("anonymously_post_comment_button"),n=layer.load(0,{shade:.18}),e=tinyMCE.activeEditor;$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"comment",comment_content:$('textarea[name="comment_content"]').val(),document_id:$('button[name="document_id"]').val(),is_public:t},success:function(t){$("#comment_update_div").html(t),i(),e.setContent(""),layer.close(n)}})}else layer.msg('<span style="color: #ECECEC">You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first</span>')}),window.hasOwnProperty("MathJax")&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}},385:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.prepareNavbarFunction=void 0;var o=e(22);e(253),e(105);n.prepareNavbarFunction=function(){$("#collect_button").on("click",function(){var t=$(this).find(".fa");t.hasClass("fa-star-o")?(layer.msg("Collected"),t.removeClass("fa-star-o"),t.addClass("fa-star"),$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"collect",document_id:$("button[name='document_id']").val()}})):t.hasClass("fa-star")&&(layer.msg("Uncollected"),t.removeClass("fa-star"),t.addClass("fa-star-o"),$.post({url:"",data:{csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),operation:"uncollect",document_id:$("button[name='document_id']").val()}}))}),$("#show_annotation_frame_button").on("click",function(){$(".Annotation").each(function(){$(this).slideDown(180)})}),$("#hide_annotation_frame_button").on("click",function(){$(".Annotation").each(function(){$(this).slideUp(180)})}),$("#instruction_button").on("click",function(){layer.photos({photos:{data:[{src:"/media/images/gif/how_to_create_annotation.gif",alt:"How to create an annotation"}]},shift:5,tab:function(t,n){$(".layui-layer-imgsee").find("em").remove()}})}),$("#readlist_button").on("click",function(){var t=layer.open({title:!1,type:1,shade:.18,shadeClose:!0,content:$("#readlist"),area:"28%",closeBtn:!1,skin:"layui-layer-molv",btn:["OK"],yes:function(){var n=[],e=[],a=!0,i=!1,r=void 0;try{for(var s,c=$("#add_to_readlist_form").find(".readlist-checkbox").toArray()[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;(l=$(l)).attr("checked")?n.push(l.val()):e.push(l.val())}}catch(t){i=!0,r=t}finally{try{!a&&c.return&&c.return()}finally{if(i)throw r}}var u="/file_viewer/api/documents/"+$("#document-id").val()+"/changereadlists",d={csrfmiddlewaretoken:(0,o.getCookie)("csrftoken"),add_readlists:n,remove_readlists:e};void 0!==$("#coterie-uuid").val()&&(u="/coterie/api/coteriedocuments/"+$("#document-id").val()+"/changereadlists",d.coterie_id=$("#coterie-id").val()),$.post({url:u,data:d,success:function(){layer.close(t)}})}});$("#close-readlist-icon").on("click",function(){layer.close(t),$(this).off("click")})});var t="/file_viewer/api/readlists",n=$("#coterie-uuid").val();void 0!==n&&(t="/coterie/api/coteries/"+n+"/members/me/coteriereadlists"),$.get({url:t,success:function(t){var n=t.created_readlists,e=$("#add_to_readlist_form"),o=e.find("#checkbox_template"),a=!0,i=!1,r=void 0;try{for(var s,c=n[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,u=o.clone();u.find("label").text(l.name),u.attr("title",l.name),u.find("input").val(l.uuid).addClass("readlist-checkbox"),u.css("display","block"),l.documents_uuids.includes($("#document-uuid").val())&&u.find("input").attr("checked","true"),e.append(u)}}catch(t){i=!0,r=t}finally{try{!a&&c.return&&c.return()}finally{if(i)throw r}}$("#add_to_readlist_form").find(".readlist-checkbox").on("change",function(t){var n=$(t.target);n.attr("checked",!n.attr("checked"))})}})}},43:function(t,n,e){"use strict";(function(n){var o=e(13),a=e(109),i={"Content-Type":"application/x-www-form-urlencoded"};function r(t,n){!o.isUndefined(t)&&o.isUndefined(t["Content-Type"])&&(t["Content-Type"]=n)}var s={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=e(54):void 0!==n&&(t=e(54)),t}(),transformRequest:[function(t,n){return a(n,"Content-Type"),o.isFormData(t)||o.isArrayBuffer(t)||o.isBuffer(t)||o.isStream(t)||o.isFile(t)||o.isBlob(t)?t:o.isArrayBufferView(t)?t.buffer:o.isURLSearchParams(t)?(r(n,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):o.isObject(t)?(r(n,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};o.forEach(["delete","get","head"],function(t){s.headers[t]={}}),o.forEach(["post","put","patch"],function(t){s.headers[t]=o.merge(i)}),t.exports=s}).call(this,e(50))},476:function(t,n,e){"use strict";var o,a,i,r,s=e(253),c=e(384),l=e(22),u=e(385),d=e(105),f=0,p=1.08,m=1,h=[],v=[],y=!1,g=1.8;function _(t){t>=1&&t<=f&&v.push([t,"PENDING",null])}function b(t){if(m*=t,v.length>0){for(;v.length>1;)v.pop();v.push([v[0][0],"PENDING",null])}for(var n=0;n<h.length;n++){var e="page_canvas_"+h[n],o=document.getElementById(e);o.width=0,o.height=0,v.push([h[n],"PENDING",null])}h=[],y||A(v,h,m);var r=$("#file_viewer")[0].scrollHeight;a*=t,i*=t,$(".page_div").each(function(){var t=$(this);t.css("width",a+"px"),t.css("height",i+"px")}),w(t);var s=$("#file_viewer")[0].scrollHeight/r;$("#file_viewer").scrollTop(parseFloat($("#file_viewer").scrollTop())*s)}function w(t){$(".Annotation").each(function(){$(this).css("top",parseFloat($(this).css("top"))*t+"px"),$(this).css("left",parseFloat($(this).css("left"))*t+"px"),$(this).css("width",parseFloat($(this).css("width"))*t+"px"),$(this).css("height",parseFloat($(this).css("height"))*t+"px")})}function k(){var t=$("#scroll_page_into_view_div").children("input"),n=$("#scroll_page_into_view_div").children("button");t.attr("min","1"),t.attr("max",f.toString()),n.on("click",function(){var n=t.val();if(n<1||n>f)return layer.msg("Input page index out of bounds"),!1;!function(t){var n=$("#file_viewer"),e=t.offset().top-n.offset().top+n.scrollTop();n.animate({scrollTop:parseInt(e)},240)}($("#"+("page_div_"+n)))})}function x(){var t=$("#wrapper"),n=$("#file_viewer"),e=$("#annotation-update-div");t.css("height",document.body.clientHeight-28+"px"),t.css("width",document.body.clientWidth),n.css("height",t.height()+"px"),n.css("width",.6*parseInt(t.css("width"))+"px"),e.css("height",t.height()+"px"),e.css("width",t.width()-3.8-n.width()+"px"),e.css("display","block"),$("#horizontal-draggable").css("height",t.height()+"px")}function C(){$(document).off("keydown"),$(document).keydown(function(t){(t.ctrlKey||t.metaKey)&&187==t.which?(t.preventDefault(),b(p)):(t.ctrlKey||t.metaKey)&&189==t.which&&(t.preventDefault(),b(1/p))})}function A(t,n,e){if(!(t.length<=0)){y=!0,$("#btn-for-larger, #btn-for-smaller").attr("disabled",!0),$(document).off("keydown"),$(document).keydown(function(t){(t.ctrlKey||t.metaKey)&&187==t.which?t.preventDefault():(t.ctrlKey||t.metaKey)&&189==t.which&&t.preventDefault()});var a=t[0][0];o.getPage(a).then(function(o){var i="page_canvas_"+a,r=document.getElementById(i),s=r.getContext("2d"),c=o.getViewport(g*e);r.height=c.height,r.width=c.width,r.style.height=c.height/g+"px",r.style.width=c.width/g+"px";var l={canvasContext:s,viewport:c};t[0][2]=o.render(l),t[0][1]="RENDERING",t[0][2].promise.then(function(){t.shift(),n.push(a),y=!1,$("#btn-for-larger, #btn-for-smaller").attr("disabled",!1),C(),A(t,n,e)},function(t){console.log("rejected because of this reason: "+t)})})}}$(document).ready(function(){!function(t){PDFJS.workerSrc="/static/pdfjs/pdf.worker.js";var n=layer.load(1,{shade:!1,offset:"48%"});PDFJS.getDocument(t).then(function(t){layer.close(n),f=(o=t).numPages,k(),o.getPage(f).then(function(t){m=.8*$("#file_viewer").width()/t.getViewport(1).width;var n="";i=t.getViewport(m).height,a=t.getViewport(m).width;for(var e=1;e<=o.numPages;e++){var c="page_div_"+e,u="page_canvas_"+e,p="<div class='page_div' id='"+c+"'><canvas class='PageCanvas' id='"+u+"'></canvas></div><br>";n+=p}$("#file_viewer").append(n),$(".page_div").css("height",i+"px"),$(".page_div").css("width",a+"px"),function(){var t="rgba(0,0,0,0.18)";r.on("change",function(n){var e=(0,l.hexToRgb)(n);t="rgba("+e.r+","+e.g+","+e.b+",0.18)"}),$("#annotation-color-buttons-div").find(".ColorSelectorButton").on("click",function(){t=$(this).css("background-color")}),$(".PageDiv, .page_div").on("mousedown",function(n){if(!$(n.target).hasClass("ui-draggable")&&!$(n.target).hasClass("ui-resizable-handle")){layer.closeAll(),$(".ui-draggable.Annotation").remove();var e=$(this).find(".PageImg, .PageCanvas"),o=n.pageX,a=n.pageY,i=o-e.offset().left,r=a-e.offset().top,c=$('<div class="Annotation"></div>');e.parents(".page_div, .PageDiv").append(c),c.css({background:t,position:"absolute",width:"1px",height:"1px",left:i,top:r}),$(".PageImg, .PageCanvas, .Annotation").on("mousemove",function(t){var n=t.pageX,o=t.pageY,a=n-e.offset().left,s=o-e.offset().top;c.css({width:Math.abs(a-i),height:Math.abs(s-r),left:Math.min(i,a),top:Math.min(r,s)}),t.stopPropagation()}),$("body").on("mouseup",function(n){if($(n.target).hasClass("PageImg")||$(n.target).hasClass("PageCanvas")||$(n.target).hasClass("Annotation")){var o=e.height(),a=e.width(),i=parseFloat(c.css("top"))/o,r=parseFloat(c.css("left"))/a,u=parseFloat(c.css("height"))/o,f=parseFloat(c.css("width"))/a;if(i+u>1||r+f>1)return c.remove(),$(".PageImg, .PageCanvas, .Annotation").off("mousemove"),$("body").off("mouseup"),void n.stopPropagation();if(u<.008&&f<.008){var p=c.parent(".page_div");c.remove();var m=p.find(".Annotation").toArray(),h=(0,s.findTargetAnnotation)(n,m,p);return void 0!=h[0]&&(0,s.scrollAnnotationDivIntoView)($('.AnnotationDiv[annotation_id="{0}"]'.format(h.attr("annotation_id")))),$(".PageImg, .PageCanvas, .Annotation").off("mousemove"),$("body").off("mouseup"),void n.stopPropagation()}c.draggable({containment:"parent"}).resizable({containment:"parent"});var v=layer.open({type:1,title:"Comment on this area",shadeClose:!0,shade:!1,maxmin:!0,zIndex:800,fixed:!1,content:'<form id="annotation_form">                        <textarea name="annotation_content" class="form-control" rows="8" style="resize: vertical"></textarea>                        <button type="button" class="post_annotation_button anonymously_post_annotation_button btn" name="document_id" value="{{ document.id }}" style="margin: 8px; float: right; border-radius: 0; color: white; background-color: #636e72">                          <i class="fa fa-user-secret"></i> &nbsp post anonymously                        </button>                        <button type="button" class="post_annotation_button btn " name="document_id" value="{{ document.id }}" style="margin: 8px; float: right; border-radius: 0; color: white; background-color: #1BA39C">post annotation</button>                    </form>',success:function(){(0,d.tinymceInit)()},cancel:function(){c.remove()}});$(document).on("keyup",function(t){27==t.keyCode&&(layer.close(v),c.remove(),$(document).off("keyup"))});var y=$('.layui-layer[times="{0}"]'.format(v));y.find(".post_annotation_button").on("click",function(){if(is_authenticated){var n=!this.classList.contains("anonymously_post_annotation_button");$.post({url:"",data:{csrfmiddlewaretoken:(0,l.getCookie)("csrftoken"),operation:"annotate",annotation_content:y.find('textarea[name="annotation_content"]').val(),page_id:e.attr("id"),top_percent:parseFloat(c.css("top"))/o,left_percent:parseFloat(c.css("left"))/a,height_percent:parseFloat(c.css("height"))/o,width_percent:parseFloat(c.css("width"))/a,frame_color:t,document_id:$('button[name="document_id"]').val(),is_public:n},success:function(t){c.draggable("destroy").resizable("destroy");var n=$(t.new_annotationdiv_html),e=n.attr("page"),o=$($(".AnnotationDiv").toArray().find(function(t){return parseInt(t.getAttribute("page"))>=parseInt(n.attr("page"))}));void 0==o[0]?$("#annotation-update-div").children("hr").before(n):o[0].getAttribute("page")==e?(o.before(n),o.children(".PageDivider").replaceWith("<hr>")):o[0].getAttribute("page")>e&&o.before(n),n.children("hr").replaceWith((0,s.getPageDividerJQ)(e)),(0,s.addAnnotationRelatedListenerWithin)(n),(0,s.addAnnotationRelatedListenerWithin)(c),(0,d.tinymceInit)(),c.attr("annotation_id",t.new_annotation_id),c.attr("annotation_uuid",t.new_annotation_uuid),(0,s.scrollAnnotationDivIntoView)(n),setTimeout(function(){var t=n.find(".AnnotationBlock");t.css("background-color","#bdede5"),t.animate({backgroundColor:"white"},1800)},180),layer.close(v)}}),y.find(".post_annotation_button").attr("disabled",!0)}else layer.msg('You need to <a href="/sign-in" style="color: #ECECEC; text-decoration: underline">log in</a> first')}),$(".PageImg, .PageCanvas, .Annotation").off("mousemove"),$("body").off("mouseup"),y.find(".post_annotation_button").attr("disabled",!1)}else c.remove(),$(".PageImg, .PageCanvas, .Annotation").off("mousemove"),$("body").off("mouseup");n.stopPropagation()}),n.stopPropagation()}})}(),drawAllExistingAnnotationFrame(),(0,s.addAnnotationRelatedListener)();for(var e=1;e<=5;e++)_(e);A(v,h,m),function(){var t=1;$("#file_viewer").scroll(function(){var n=this.scrollTop/this.scrollHeight,e=Math.ceil(n*f);if(e!=t){t=e;for(var o=(0,l.range)(6).map(function(t){return!0}),a=0,i=0;i<h.length;i++)if(h[a]-e>=-2&&h[a]-e<=3)o[h[a]-(e-2)]=!1,a+=1;else{var r="page_canvas_"+h[a],s=document.getElementById(r);s.width=0,s.height=0,h.splice(a,1)}v.splice(1);for(var i=0;i<o.length;i++)o[i]&&_(e-2+i);y||A(v,h,m)}})}(),function(){var t=(0,l.getValFromUrlParam)("annotation");if(null!=t){var n=(0,l.getValFromUrlParam)("mark-read-url");null!=n&&$.get(n),t=t.replace(/-/g,"");var e=$('.AnnotationDiv[annotation_uuid="{0}"]'.format(t)),o=$('.Annotation[annotation_uuid="{0}"]'.format(t));(0,s.scrollAnnotationDivIntoView)(e),(0,s.scrollAnnotationIntoView)(o),e.find(".AnnotationBlock").prepend($('<span class="badge" style="background-color: #1BA39C; margin-bottom: 6px">highlighted annotation</span>')),setTimeout(function(){var t=e.find(".AnnotationBlock");t.css("background-color","#bdede5"),t.animate({backgroundColor:"white"},1800)},380)}}()})})}($("#file-url").val()),(0,d.tinymceInit)(),(0,c.enablePostCommentButton)(),(0,c.enableRefreshCommentButton)(),$("#btn-for-larger").on("click",function(){b(p)}),$("#btn-for-smaller").on("click",function(){b(1/p)}),C(),(0,u.prepareNavbarFunction)(),$(window).resize(function(){x();var t=parseFloat($(".PageImg").css("width"));w(parseFloat($(".PageImg").css("width"))/t)}),r=new Huebee(".color-picker",{notation:"hex",saturations:2}),(0,c.addCommentRelatedListener)(),x();var t=$("#wrapper"),n=$("#file_viewer");$("#horizontal-draggable").draggable({axis:"x",containment:"#containment-wrapper",revert:!0,revertDuration:0,stop:function(e,o){var a=o.offset.left;n.css("width",a+"px"),$("#annotation-update-div").css("width",t.width()-3-n.width()+"px")}}),function(){var t="0",n=!0,e=!1,o=void 0;try{for(var a,i=$(".AnnotationDiv")[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var r=a.value,c=$(r);if(c.attr("page")!=t){var l=c.attr("page");c.children("hr").replaceWith((0,s.getPageDividerJQ)(l)),t=l}}}catch(t){e=!0,o=t}finally{try{!n&&i.return&&i.return()}finally{if(e)throw o}}}()})},50:function(t,n){var e,o,a=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{o="function"==typeof clearTimeout?clearTimeout:r}catch(t){o=r}}();var c,l=[],u=!1,d=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&p())}function p(){if(!u){var t=s(f);u=!0;for(var n=l.length;n;){for(c=l,l=[];++d<n;)c&&c[d].run();d=-1,n=l.length}c=null,u=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===r||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(t)}}function m(t,n){this.fun=t,this.array=n}function h(){}a.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new m(t,n)),1!==l.length||u||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},53:function(t,n,e){"use strict";t.exports=function(t,n){return function(){for(var e=new Array(arguments.length),o=0;o<e.length;o++)e[o]=arguments[o];return t.apply(n,e)}}},54:function(t,n,e){"use strict";var o=e(13),a=e(110),i=e(112),r=e(113),s=e(114),c=e(55),l="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||e(115);t.exports=function(t){return new Promise(function(n,u){var d=t.data,f=t.headers;o.isFormData(d)&&delete f["Content-Type"];var p=new XMLHttpRequest,m="onreadystatechange",h=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||s(t.url)||(p=new window.XDomainRequest,m="onload",h=!0,p.onprogress=function(){},p.ontimeout=function(){}),t.auth){var v=t.auth.username||"",y=t.auth.password||"";f.Authorization="Basic "+l(v+":"+y)}if(p.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),p.timeout=t.timeout,p[m]=function(){if(p&&(4===p.readyState||h)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in p?r(p.getAllResponseHeaders()):null,o={data:t.responseType&&"text"!==t.responseType?p.response:p.responseText,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:e,config:t,request:p};a(n,u,o),p=null}},p.onerror=function(){u(c("Network Error",t,null,p)),p=null},p.ontimeout=function(){u(c("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",p)),p=null},o.isStandardBrowserEnv()){var g=e(116),_=(t.withCredentials||s(t.url))&&t.xsrfCookieName?g.read(t.xsrfCookieName):void 0;_&&(f[t.xsrfHeaderName]=_)}if("setRequestHeader"in p&&o.forEach(f,function(t,n){void 0===d&&"content-type"===n.toLowerCase()?delete f[n]:p.setRequestHeader(n,t)}),t.withCredentials&&(p.withCredentials=!0),t.responseType)try{p.responseType=t.responseType}catch(n){if("json"!==t.responseType)throw n}"function"==typeof t.onDownloadProgress&&p.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){p&&(p.abort(),u(t),p=null)}),void 0===d&&(d=null),p.send(d)})}},55:function(t,n,e){"use strict";var o=e(111);t.exports=function(t,n,e,a,i){var r=new Error(t);return o(r,n,e,a,i)}},56:function(t,n,e){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},57:function(t,n,e){"use strict";function o(t){this.message=t}o.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},o.prototype.__CANCEL__=!0,t.exports=o}});