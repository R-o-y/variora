(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t){e.exports="data:image/png;base64,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"},241:function(e,t,n){},297:function(e,t,n){e.exports=n(635)},298:function(e,t,n){},303:function(e,t,n){},597:function(e,t,n){},622:function(e,t,n){},635:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"getUser",function(){return ce}),n.d(a,"signOff",function(){return ue}),n.d(a,"getMyDocuments",function(){return de}),n.d(a,"uploadDocument",function(){return Ae}),n.d(a,"uploadCoterieDocument",function(){return pe}),n.d(a,"renameDocument",function(){return me}),n.d(a,"deleteDocument",function(){return he}),n.d(a,"deleteDocumentSuccess",function(){return fe}),n.d(a,"uncollectDocument",function(){return ge}),n.d(a,"uncollectDocumentSuccess",function(){return ve}),n.d(a,"getMyReadlists",function(){return ye}),n.d(a,"getReadlist",function(){return Ee}),n.d(a,"deleteReadlist",function(){return Ce}),n.d(a,"deleteReadlistSuccess",function(){return ke}),n.d(a,"getExploreDocuments",function(){return be}),n.d(a,"getExploreReadlists",function(){return we}),n.d(a,"getCombinedNotifications",function(){return Ie}),n.d(a,"markNotificationAsRead",function(){return Be}),n.d(a,"markAllNotificationsAsRead",function(){return De}),n.d(a,"getMyCoteries",function(){return Oe}),n.d(a,"getMyCoteriesDocument",function(){return Se}),n.d(a,"getMyCoteriesReadlists",function(){return xe}),n.d(a,"createReadlist",function(){return je}),n.d(a,"editReadlist",function(){return Re}),n.d(a,"collectReadlist",function(){return Me}),n.d(a,"collectReadlistSuccess",function(){return _e}),n.d(a,"uncollectReadlist",function(){return Te}),n.d(a,"uncollectReadlistSuccess",function(){return Qe}),n.d(a,"documentChangeReadlists",function(){return Pe}),n.d(a,"removeFromReadlistSuccess",function(){return Ne}),n.d(a,"createCoterie",function(){return Le}),n.d(a,"updateCoterie",function(){return Ye}),n.d(a,"updateCoterieSuccess",function(){return Fe}),n.d(a,"leaveCoterie",function(){return Ue}),n.d(a,"deleteCoterie",function(){return He}),n.d(a,"getSearchResults",function(){return ze}),n.d(a,"getCoterieSearchResults",function(){return Ge}),n.d(a,"inviteToCoterie",function(){return We}),n.d(a,"removeMember",function(){return Je}),n.d(a,"getInvitations",function(){return Xe}),n.d(a,"acceptInvitation",function(){return Ve}),n.d(a,"declineInvitation",function(){return Ke});n(298),n(151),n(301);var r=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function o(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available; please refresh."),t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t.onSuccess&&t.onSuccess(e)))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var i=n(640),s=n(642),l=n(643),c=n(641),u=n(75),d=n(15),A=n(16),p=n(19),m=n(17),h=n(18),f=(n(303),n(305),n(0)),g=n.n(f),v=n(4),y=n.n(v),E=n(20),C=n(14),k=n.n(C),b="user_get",w="user_sign_off",I="document_get_my",B="document_get_my_documents",D="document_get_explore",O="document_upload",S="document_rename",x="document_delete_success",j="document_uncollect_success",R="readlist_get_my",M="readlist_get_explore",_="readlist_get",T="readlist_create",Q="readlist_edit",P="readlist_delete_success",N="readlist_collect_success",L="readlist_uncollect_success",Y="readlist_remove_document_success",F="notification_get_combined",U="notification_read",H="notification_read_all_success",z="notification_read_all_error",G="search_result_get",W="search_error",J="coterie_get_my",X="coterie_create",V="coterie_update",K="coterie_update_success",Z="coterie_invite",q="coterie_member_delete",$="coterie_document_upload",ee="coterie_leave",te="coterie_delete",ne="invitation_get",ae="invitation_accept",re="invitation_decline",oe="/file_viewer/api/documents/upload",ie="/coterie/api/coteriedocuments/upload",se="/coterie/api/invite",le="/coterie/api/invitations";function ce(){var e=k.a.get("/api/user");return{type:b,payload:e}}function ue(e){var t=k()({method:"post",url:"/api/signoff",data:e});return{type:w,payload:t}}function de(){var e=k.a.get("/file_viewer/api/documents");return{type:I,payload:e}}function Ae(e){var t=k()({method:"post",headers:{"Content-Type":"multipart/form-data"},url:oe,data:e});return{type:O,payload:t}}function pe(e){var t=k()({method:"post",headers:{"Content-Type":"multipart/form-data"},url:ie,data:e});return{type:$,payload:t}}function me(e,t){var n=k()({method:"post",url:e,data:t});return{type:S,payload:n}}function he(e,t,n){return function(a){return k()({method:"post",url:e,data:t}).then(function(){a(fe(n))}).catch(function(e){throw e})}}function fe(e){return{type:x,payload:e}}function ge(e,t,n){return function(a){return k()({method:"post",url:e,data:t}).then(function(){a(ve(n))}).catch(function(e){throw e})}}function ve(e){return{type:j,payload:e}}function ye(){var e=k.a.get("/file_viewer/api/readlists");return{type:R,payload:e}}function Ee(e){var t="/file_viewer/api/readlists/"+e,n=k.a.get(t);return{type:_,payload:n}}function Ce(e,t,n){return function(a){return k()({method:"post",url:e,data:t}).then(function(){a(fe(n))}).catch(function(e){throw e})}}function ke(e){return{type:P,payload:e}}function be(){var e=k.a.get("/file_viewer/api/documents/explore");return{type:D,payload:e}}function we(){var e=k.a.get("/file_viewer/api/readlists/explore");return{type:M,payload:e}}function Ie(){var e=k.a.get("/notifications/api/combined");return{type:F,payload:e}}function Be(e,t){var n=k.a.get(e);return{type:U,payload:n,slug:t}}function De(e,t){return function(n){k()({method:"post",url:"/notifications/api/mark-all-as-read",data:e}).then(function(e){n({type:H,payload:{unreadNotificationSlug:t}})}).catch(function(e){n({type:z})})}}function Oe(){var e=k.a.get("/coterie/api/coteries");return{type:J,payload:e}}function Se(e){var t="/coteries/api/coteries/".concat(e,"/members/me/uploaded-documents"),n=k.a.get(t);return{type:B,payload:n}}function xe(e){}function je(e){var t=k()({method:"post",url:"/file_viewer/api/readlists/create",data:e});return{type:T,payload:t}}function Re(e,t){var n=k()({method:"post",url:e,data:t});return{type:Q,payload:n}}function Me(e,t){var n="/file_viewer/api/readlists/"+t+"/collect";return function(a){return k()({method:"post",url:n,data:e}).then(function(){a(_e(t))}).catch(function(e){throw e})}}function _e(e){return{type:N,payload:e}}function Te(e,t){var n="/file_viewer/api/readlists/"+t+"/uncollect";return function(a){return k()({method:"post",url:n,data:e}).then(function(){a(Qe(t))}).catch(function(e){throw e})}}function Qe(e){return{type:L,payload:e}}function Pe(e,t){var n="/file_viewer/api/documents/"+e+"/changereadlists";return console.log("making req to "+n+" with data"),console.log(t),function(e){return k()({method:"post",url:n,data:t}).then(function(){e(Ne())}).catch(function(e){throw e})}}function Ne(){return{type:Y,payload:{}}}function Le(e){var t=k()({method:"post",url:"/coterie/api/coteries/create",data:e});return{type:X,payload:t}}function Ye(e,t){var n="/coterie/api/coteries/".concat(t,"/update"),a=k()({method:"post",url:n,data:e});return{type:V,payload:a}}function Fe(e,t,n){return{type:K,payload:{uuid:e,name:t,description:n}}}function Ue(e,t,n){var a="/coterie/api/coteries/".concat(t,"/exit"),r=k()({method:"post",url:a,data:e});return{type:ee,payload:r,uuid:n}}function He(e,t,n){var a="/coterie/api/coteries/".concat(t,"/delete"),r=k()({method:"post",url:a,data:e});return{type:te,payload:r,uuid:n}}function ze(e){var t="/api/search?key="+e;return function(e){k.a.get(t).then(function(t){e({type:G,payload:t})}).catch(function(t){e({type:W})})}}function Ge(e,t){var n="/coterie/api/coteries/"+t+"/search?key="+e;return function(e){k.a.get(n).then(function(t){e({type:G,payload:t})}).catch(function(t){e({type:W})})}}function We(e){var t=k()({method:"post",url:se,data:e});return{type:Z,payload:t}}function Je(e,t,n,a){return function(r){return k()({method:"post",url:e,data:t}).then(function(e){r({type:q,payload:{uuid:n,email:a}})}).catch(function(e){throw e})}}function Xe(){var e=k.a.get(le);return{type:ne,payload:e}}function Ve(e,t,n){var a=k()({method:"post",url:e,data:t});return{type:ae,payload:a,pk:n}}function Ke(e,t,n){var a=k()({method:"post",url:e,data:t});return{type:re,payload:a,pk:n}}n(337);var Ze=n(86),qe=n.n(Ze),$e=(n(211),n(187)),et=n.n($e),tt=n(194),nt=n.n(tt),at=n(195),rt=n.n(at),ot=n(196),it=n.n(ot),st=n(193),lt=n.n(st),ct=n(261),ut=n.n(ct),dt=n(197),At=n.n(dt),pt=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={selectedTab:n.props.path.split("/").pop(),hidden:!1},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"getGroupPath",value:function(){var e=this.props.path,t=e.split("/").slice(1);return t.length>=1&&"groups"===t[0]?e.split("/").slice(0,-1).join("/"):""}},{key:"renderNotificationTabWithBadge",value:function(){var e=y.a.filter(this.props.notifications,"unread");return y.a.isEmpty(e)&&y.a.isEmpty(this.props.invitations)?g.a.createElement(lt.a,null):g.a.createElement(et.a,{dot:!0},g.a.createElement(lt.a,null))}},{key:"getVisibleHeightString",value:function(){return!0===window.navigator.standalone?"calc(100% - 50px - env(safe-area-inset-bottom))":"calc(100% - 50px)"}},{key:"render",value:function(){var e=this;return g.a.createElement("div",{style:{position:"fixed",height:this.getVisibleHeightString(),width:"calc(100% - env(safe-area-inset-left) - env(safe-area-inset-right)",top:50,paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}},g.a.createElement(qe.a,{unselectedTintColor:"#949494",tintColor:"#1BA39C",barTintColor:"white",hidden:this.state.hidden},g.a.createElement(qe.a.Item,{icon:g.a.createElement(nt.a,null),selectedIcon:g.a.createElement(nt.a,null),title:"explore"===this.state.selectedTab?"explore":"",key:"explore",selected:"explore"===this.state.selectedTab,onPress:function(){e.setState({selectedTab:"explore"}),e.props.history.push("".concat(e.getGroupPath(),"/explore"))}},"explore"===this.state.selectedTab&&this.props.content),g.a.createElement(qe.a.Item,{icon:g.a.createElement(rt.a,null),selectedIcon:g.a.createElement(rt.a,null),title:"uploads"===this.state.selectedTab?"uploads":"",key:"Uploads",selected:"uploads"===this.state.selectedTab,onPress:function(){e.setState({selectedTab:"uploads"}),e.props.history.push("".concat(e.getGroupPath(),"/uploads"))}},"uploads"===this.state.selectedTab&&this.props.content),g.a.createElement(qe.a.Item,{icon:g.a.createElement(it.a,null),selectedIcon:g.a.createElement(it.a,null),title:"readlists"===this.state.selectedTab?"readlists":"",key:"Readlists",selected:"readlists"===this.state.selectedTab,onPress:function(){e.setState({selectedTab:"readlists"}),e.props.history.push("".concat(e.getGroupPath(),"/readlists"))}},"readlists"===this.state.selectedTab&&this.props.content),g.a.createElement(qe.a.Item,{icon:this.renderNotificationTabWithBadge(),selectedIcon:g.a.createElement(ut.a,null),title:"notifications"===this.state.selectedTab?"notifications":"",key:"Notifications",selected:"notifications"===this.state.selectedTab,onPress:function(){e.setState({selectedTab:"notifications"}),e.props.history.push("".concat(e.getGroupPath(),"/notifications"))}},"notifications"===this.state.selectedTab&&this.props.content),g.a.createElement(qe.a.Item,{icon:g.a.createElement(At.a,null),selectedIcon:g.a.createElement(At.a,null),title:"settings"===this.state.selectedTab?"settings":"",key:"Settings",selected:"settings"===this.state.selectedTab,onPress:function(){e.setState({selectedTab:"settings"}),e.props.history.push("".concat(e.getGroupPath(),"/settings"))}},"settings"===this.state.selectedTab&&this.props.content)))}}]),t}(g.a.Component);var mt=Object(E.b)(function(e){return{notifications:e.notifications,invitations:e.invitations}})(pt),ht=(n(65),n(42)),ft=n.n(ht),gt=(n(93),n(55)),vt=n.n(gt),yt=(n(94),n(36)),Et=n.n(yt),Ct=(n(54),n(34)),kt=n.n(Ct),bt=(n(45),n(3)),wt=n.n(bt),It=n(33),Bt=n(38),Dt=n(44),Ot=n(47),St=n.n(Ot),xt=n(40),jt=n(99),Rt=n.n(jt),Mt=n(264),_t=n.n(Mt),Tt=(n(95),n(29)),Qt=n.n(Tt);function Pt(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var r=n[a].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}function Nt(e){var t=document.createElement("span");t.style.hidden=!0,t.innerHTML=e,document.body.appendChild(t);var n=document.createRange();n.selectNodeContents(t);var a=window.getSelection();a.removeAllRanges(),a.addRange(n),document.execCommand("copy"),document.body.removeChild(t)}var Lt=5242880;function Yt(e){return["#f472d0","#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#f1c40f","#e67e22","#e74c3c"][e.charCodeAt(0)%9]}var Ft=n(63);Ft.b.add(Bt.m,Bt.l,Bt.k);var Ut=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={coterieModal:!1},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"showModal",value:function(e,t){t.preventDefault(),this.setState(Object(It.a)({},e,!0))}},{key:"onClose",value:function(e){this.setState(Object(It.a)({},e,!1))}},{key:"onToggle",value:function(e){this.setState(Object(It.a)({},e,!this.state[e]))}},{key:"getNavbarTitle",value:function(e){var t=this.props.coteries[this.props.match.params.groupUuid],n=this.props.path?this.props.path.split("/").pop():"";return t&&"explore"===n?t.name:n?n.charAt(0).toUpperCase()+n.slice(1):n}},{key:"goToGroup",value:function(e){var t=this.props.history.location.pathname.split("/").pop();this.props.history.push("/groups/".concat(e,"/").concat(t))}},{key:"renderCoterieItem",value:function(e){var t=this,n=this.props.coteries[e];return g.a.createElement(wt.a.Item,{key:n.pk,extra:n.members.length+" members",align:"top",style:{backgroundColor:this.props.match.params.groupUuid===n.uuid?"#edf9f6":""},onClick:function(){t.goToGroup(n.uuid),t.onClose("coterieModal")}},n.name,g.a.createElement(wt.a.Item.Brief,null,n.description))}},{key:"render",value:function(){var e=this,t=!y.a.isEmpty(this.props.user.administratedCoteries),n=!y.a.isEmpty(this.props.user.joinedCoteries),a=this.props.coteries[this.props.match.params.groupUuid];return g.a.createElement(ft.a,{mode:"light",style:{boxShadow:"0px 1px 3px rgba(28, 28, 28, .1)",zIndex:1e7,position:"fixed",width:"98%",paddingRight:8,height:50},leftContent:this.props.user.portrait_url&&g.a.createElement(St.a,{alt:"avatar",style:{width:28,height:28},src:this.props.user.portrait_url,onClick:function(t){e.props.history.push("/profile")}}),rightContent:[g.a.createElement(kt.a,{key:"0",type:"search",style:{marginRight:"16px"},onClick:function(t){e.props.match.params.groupUuid?e.props.history.push("/search/"+e.props.match.params.groupUuid):e.props.history.push("/search")}}),g.a.createElement("div",{key:"1"},a?g.a.createElement(_t.a,{color:"primary",classes:{badge:this.props.classes.badge},badgeContent:g.a.createElement(St.a,{className:this.props.classes.avatar,style:{backgroundColor:Yt(this.props.match.params.groupUuid)}},g.a.createElement("span",{style:{fontSize:"80%"}},this.props.coteries[this.props.match.params.groupUuid]?this.props.coteries[this.props.match.params.groupUuid].name.charAt(0):""))},g.a.createElement(Rt.a,{style:{color:"rgb(101, 119, 134)",height:25,width:25},onClick:function(t){if(!e.props.user||!e.props.user.is_authenticated)return Et.a.alert("","You need to sign in to view and switch groups",[{text:"Cancel",onPress:function(){}},{text:"Go login",onPress:function(){return e.props.history.push("/sign-in")}}]);e.props.getMyCoteries(),e.onToggle("coterieModal")}})):g.a.createElement(Rt.a,{style:{color:"rgb(101, 119, 134)",height:25,width:25},onClick:function(t){if(!e.props.user||!e.props.user.is_authenticated)return Et.a.alert("","You need to sign in to view and switch groups",[{text:"Cancel",onPress:function(){}},{text:"Go login",onPress:function(){return e.props.history.push("/sign-in")}}]);e.props.getMyCoteries(),e.onToggle("coterieModal")}}),g.a.createElement(Et.a,{popup:!0,visible:this.state.coterieModal,onClose:function(){return e.onClose("coterieModal")},animationType:"slide-up"},g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",{style:{color:"#1BA39C"}},"SWITCH GROUP")},className:"popup-list"},g.a.createElement(wt.a,{style:{overflow:"auto",maxHeight:"60vh"}},g.a.createElement(wt.a.Item,{style:{backgroundColor:this.props.match.params.groupUuid?"":"#edf9f6"},onClick:function(){var t=e.props.history.location.pathname.split("/").pop();e.props.history.push("/".concat(t)),e.onClose("coterieModal")}},"Public"),!n&&!t&&g.a.createElement("div",null,"You have not joined any groups."),t&&g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",null,"Administrated")}},this.props.user.administratedCoteries.map(function(t){return e.renderCoterieItem(t)})),n&&g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",null,"Joined")}},this.props.user.joinedCoteries.map(function(t){return e.renderCoterieItem(t)}))),g.a.createElement(wt.a.Item,null,g.a.createElement(vt.a,{type:"primary",style:{backgroundColor:"#1BA39C"},onClick:function(){e.onClose("coterieModal"),e.props.history.push("/create-coterie-form")}},"Create a new group")))))]},this.getNavbarTitle(this.props.path))}}]),t}(f.Component);var Ht=Object(E.b)(function(e){return{user:e.user,coteries:e.coteries}},a)(Object(Dt.withStyles)(function(e){return{badge:{top:6,right:-16,border:"1px solid white"},avatar:{width:"100%",height:"100%"}}})(Ut)),zt=(n(59),n(22)),Gt=n.n(zt),Wt=(n(106),n(56)),Jt=n.n(Wt),Xt=n(73),Vt=n(61),Kt=n.n(Vt),Zt=n(74),qt=(n(241),n(43)),$t=n.n(qt),en=n(60),tn=n.n(en),nn=n(41),an=n.n(nn),rn=n(190),on=n.n(rn),sn=n(188),ln=n.n(sn),cn=n(189),un=n.n(cn),dn=n(48),An=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;(function(){var t=Object(Zt.a)(Kt.a.mark(function t(){return Kt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.props.getExploreDocuments();case 3:return t.next=5,e.props.getExploreReadlists();case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return");case 11:e.setState({loading:!1});case 12:case"end":return t.stop()}},t,this,[[0,7]])}));return function(){return t.apply(this,arguments)}})()()}},{key:"renderReactSticky",value:function(e){return g.a.createElement(dn.Sticky,null,function(t){var n=t.style;return g.a.createElement("div",{style:Object(Xt.a)({},n,{zIndex:1})},g.a.createElement(Jt.a.DefaultTabBar,e))})}},{key:"renderDocumentsSubgrid",value:function(e,t){var n=this;if(!e.length)return g.a.createElement("div",null);var a=e.map(function(e){return g.a.createElement("div",{key:e.open_url},g.a.createElement(ln.a,{className:"grid-tile",key:e.open_url,onClick:function(){n.props.history.push("".concat(e.open_url))}},g.a.createElement(an.a,{container:!0,alignItems:"center",style:{height:"100%"}},g.a.createElement("img",{src:e.image,alt:e.title})),g.a.createElement(un.a,{style:{height:"25%"},title:g.a.createElement("div",{style:{fontSize:"0.8rem",fontWeight:"bold"}},e.title),subtitle:g.a.createElement("div",{style:{fontSize:"0.7rem"}},g.a.createElement(tn.a,{date:e.upload_time}))})))});return g.a.createElement("div",null,g.a.createElement(Gt.a,null),g.a.createElement("div",{style:{color:"#888",fontSize:"14px"}},t),g.a.createElement(Gt.a,null),g.a.createElement(on.a,{cellSpacing:0,cols:1,cellHeight:"auto",style:{flexWrap:"nowrap",margin:0}},a))}},{key:"renderReadlistsSublist",value:function(e,t){var n=this;if(!e.length)return g.a.createElement("div",null);var a=e.map(function(e){return g.a.createElement(wt.a.Item,{key:e.slug,extra:g.a.createElement(tn.a,{date:e.create_time}),thumb:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678072-folder-document-512.png",multipleLine:!0,onClick:function(){n.props.history.push("".concat(e.url))}},e.name,g.a.createElement(wt.a.Item.Brief,null,e.owner.nickname))});return g.a.createElement("div",null,g.a.createElement(wt.a,{renderHeader:function(){return t}},a))}},{key:"renderExploreDocuments",value:function(){var e=this.props.explore.documents;return g.a.createElement("div",null,this.renderDocumentsSubgrid(e.mostViewsDocuments,"Most Views"),this.renderDocumentsSubgrid(e.mostStarsDocuments,"Most Stars"),this.renderDocumentsSubgrid(e.mostAnnotationsDocuments,"Most Annotations"))}},{key:"renderExploreReadlists",value:function(){var e=this.props.explore.readlists;return g.a.createElement("div",null,this.renderReadlistsSublist(e.mostCollectorsReadlists,"Trending Lists"),this.renderReadlistsSublist(e.newestReadlists,"Recent Lists"))}},{key:"renderStickyTab",value:function(){return g.a.createElement("div",null,g.a.createElement(Gt.a,null),g.a.createElement(dn.StickyContainer,null,g.a.createElement(Jt.a,{tabs:[{title:"Documents"},{title:"Readlists"}],initalPage:"t2",swipeable:!1,_renderTabBar:this.renderReactSticky},g.a.createElement("div",{style:{justifyContent:"center",height:"100%"}},this.renderExploreDocuments()),g.a.createElement("div",{style:{justifyContent:"center",height:"100%"}},this.renderExploreReadlists()))),g.a.createElement(Gt.a,null))}},{key:"render",value:function(){return this.state.loading?g.a.createElement("div",null,g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5})):g.a.createElement("div",null,this.renderStickyTab())}}]),t}(f.Component);var pn=Object(E.b)(function(e){return{user:e.user,explore:e.explore}},a)(An),mn=n(72),hn=n.n(mn),fn=n(24),gn=n.n(fn),vn=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement("img",{src:hn.a,alt:"logo",style:{height:108,marginTop:"20vh"}}),g.a.createElement("h3",{style:{color:"grey"}},"You are not signed in!"),g.a.createElement("h3",{style:{color:"grey"}},"Sign in for more functionalities"),g.a.createElement(gn.a,{variant:"contained",color:"primary",onClick:function(){e.props.history.push("/sign-in")}},"Sign in"))}}]),t}(g.a.Component),yn=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement("img",{src:hn.a,alt:"logo",style:{height:108,marginTop:"20vh"}}),g.a.createElement("h3",{style:{color:"grey"}},"You are not a member of this group!"),g.a.createElement("h3",{style:{color:"grey"}},"Accept invitation and try again"),g.a.createElement(gn.a,{variant:"contained",color:"primary",onClick:function(){e.props.history.push("/explore")}},"Back to public"))}}]),t}(g.a.Component),En=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getMyCoteries().then(function(){e.setState({loading:!1})})}},{key:"renderReactSticky",value:function(e){return g.a.createElement(dn.Sticky,null,function(t){var n=t.style;return g.a.createElement("div",{style:Object(Xt.a)({},n,{zIndex:1})},g.a.createElement(Jt.a.DefaultTabBar,e))})}},{key:"renderCoterieDocuments",value:function(){var e=this,t=this.props.coteries[this.props.match.params.groupUuid].coteriedocument_set.map(function(t){return g.a.createElement(wt.a.Item,{key:t.slug,extra:g.a.createElement(tn.a,{date:t.upload_time}),thumb:"https://cdn1.iconfinder.com/data/icons/file-types-23/48/PDF-128.png",multipleLine:!0,onClick:function(){var n=e.props.match.params.groupUuid,a=e.props.coteries[n].pk;e.props.history.push("/coteries/".concat(a,"/documents/").concat(t.slug))}},t.title,g.a.createElement(wt.a.Item.Brief,null,t.uploader_name))}).reverse();return g.a.createElement(wt.a,null,t)}},{key:"renderCoterieReadlists",value:function(){return g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,null,g.a.createElement("div",{style:{color:"grey",textAlign:"center"}},"Group-based readlists still in development.")))}},{key:"renderStickyTab",value:function(){return g.a.createElement("div",null,g.a.createElement(Gt.a,null),g.a.createElement(dn.StickyContainer,null,g.a.createElement(Jt.a,{tabs:[{title:"Documents"},{title:"Readlists"}],initalPage:"t2",swipeable:!0,_renderTabBar:this.renderReactSticky},g.a.createElement("div",{style:{justifyContent:"center",height:"100%"}},this.renderCoterieDocuments()),g.a.createElement("div",{style:{justifyContent:"center",height:"100%"}},this.renderCoterieReadlists()))),g.a.createElement(Gt.a,null))}},{key:"render",value:function(){return this.state.loading?g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5}):this.props.user&&this.props.user.is_authenticated?this.props.coteries[this.props.match.params.groupUuid]?g.a.createElement("div",null,this.renderStickyTab()):g.a.createElement(yn,null):g.a.createElement(vn,{history:this.props.history})}}]),t}(f.Component);var Cn=Object(E.b)(function(e){return{user:e.user,explore:e.explore,coteries:e.coteries}},a)(En),kn=n(103),bn=n.n(kn),wn=n(83),In=n.n(wn),Bn=n(84),Dn=n.n(Bn),On=n(85),Sn=n.n(On),xn=n(82),jn=n.n(xn),Rn=n(265),Mn=n.n(Rn),_n=n(267),Tn=n.n(_n),Qn=n(266),Pn=n.n(Qn),Nn=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this))).handleEntering=function(){n.radioGroupRef.focus()},n.handleCancel=function(){n.props.onClose(n.props.value)},n.handleClear=function(){n.props.onClose(void 0)},n.handleOk=function(){n.props.onClose(n.state.value)},n.handleChange=function(e,t){n.setState({value:t})},n.state={value:e.value},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.getMyReadlists()}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({value:e.value})}},{key:"render",value:function(){var e=this,t=this.props,n=(t.value,t.onClose),a=t.open;return g.a.createElement(jn.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,maxWidth:"xs",onEntering:this.handleEntering,"aria-labelledby":"confirmation-dialog-title",onClose:n,open:a},g.a.createElement(In.a,{id:"confirmation-dialog-title"},"Select Readlist"),g.a.createElement(Dn.a,null,g.a.createElement(Mn.a,{ref:function(t){e.radioGroupRef=t},value:this.state.value,onChange:this.handleChange},y.a.isEmpty(this.props.readlists)&&g.a.createElement("span",null,"You don't have any readlist"),y.a.values(this.props.readlists).map(function(e){return g.a.createElement(Pn.a,{value:e.slug,key:e.slug,control:g.a.createElement(Tn.a,{color:"primary"}),label:e.name})}))),g.a.createElement(Sn.a,null,g.a.createElement(gn.a,{onClick:this.handleClear,color:"primary"},"Clear"),g.a.createElement(gn.a,{onClick:this.handleCancel,color:"primary"},"Cancel"),g.a.createElement(gn.a,{onClick:this.handleOk,color:"primary"},"Ok")))}}]),t}(g.a.Component);var Ln=Object(E.b)(function(e){return{readlists:e.readlists}},a)(Nn),Yn=n(268),Fn=n.n(Yn),Un=n(142),Hn=n.n(Un),zn=n(113),Gn=n.n(zn),Wn=n(143),Jn=n.n(Wn),Xn=n(100),Vn=n.n(Xn),Kn=n(50),Zn=n.n(Kn),qn=n(51),$n=n.n(qn),ea=n(115),ta=n.n(ea),na=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={uploadedActionModal:!1,collectedActionModal:!1,uploadDialog:!1,chooseReadlistRadio:!1,uploadedFile:null,selectedDocument:null,loading:!0},n.handleFileDialog=function(){var e=n.finput.files[0];n.setState({uploadDialog:!0,uploadedFile:e})},n.handleConfirmationDialogClose=function(e){n.setState({value:e,chooseReadlistRadio:!1})},n.handleFileSubmit=function(){var e=n.state.uploadedFile,t=e.name.split(".").slice(0,-1).join("."),a=n.state.name?n.state.name:t,r=n.state.value?n.props.readlists[n.state.value].uuid:void 0;if("application/pdf"===e.type){var o=n.props.user;if((void 0===o||!o.is_superuser)&&!function(e){return!(e.size>Lt)||(Qt.a.info("Document size should be less than 5 MB",1),!1)}(e))return!1;if(a.includes("."))Qt.a.fail("Special characters are not allowed in file name",2.8);else{var i=new FormData;if(i.append("title",a),i.append("file_upload",e),i.append("csrfmiddlewaretoken",Pt("csrftoken")),n.setState({uploading:!0}),Qt.a.loading("Loading..."),n.props.match.params.groupUuid){var s=n.props.coteries[n.props.match.params.groupUuid].pk;i.append("coterie_pk",s),n.props.uploadCoterieDocument(i).then(function(){Qt.a.success("Upload success!",1),n.setState({uploading:!1})}).catch(function(e){Qt.a.fail("Upload failed!",1)})}else n.props.uploadDocument(i).then(function(e){var t=e.payload.data.pk;if(r){var a=new FormData;a.append("csrfmiddlewaretoken",Pt("csrftoken")),a.append("add_readlists[]",r),n.props.documentChangeReadlists(t,a).catch(function(e){Qt.a.fail("Add to readlist failed!",2)})}}).then(function(){Qt.a.success("Upload success!",1),n.setState({uploading:!1})}).catch(function(e){Qt.a.fail("Upload failed!",2)});n.finput.value=""}}else Qt.a.fail("File type is not PDF",1.8)},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.groupUuid;t?this.props.getMyCoteriesDocument(t).then(function(){e.setState({loading:!1})}).catch(function(t){e.setState({loading:!1})}):this.props.getMyDocuments().then(function(){e.setState({loading:!1})}).catch(function(t){e.setState({loading:!1})})}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.groupUuid;t!==e.match.params.groupUuid&&(t?this.props.getMyCoteriesDocument(t):this.props.getMyDocuments())}},{key:"showModal",value:function(e,t){t.preventDefault(),this.setState(Object(It.a)({},e,!0))}},{key:"onClose",value:function(e){this.setState(Object(It.a)({},e,!1))}},{key:"renderReactSticky",value:function(e){return g.a.createElement(dn.Sticky,null,function(t){var n=t.style;return g.a.createElement("div",{style:Object(Xt.a)({},n,{zIndex:1})},g.a.createElement(Jt.a.DefaultTabBar,e))})}},{key:"renderListItem",value:function(e,t){var n=this;return g.a.createElement("div",{key:e.slug},g.a.createElement(wt.a.Item,{thumb:g.a.createElement("img",{src:ta.a,alt:"pdf-icon",style:{height:28,width:24}}),multipleLine:!0,onClick:function(){var t=n.props.match.params.groupUuid;if(t){var a=n.props.coteries[t].pk;n.props.history.push("/coteries/".concat(a,"/documents/").concat(e.slug))}else n.props.history.push("/documents/".concat(e.slug))}},g.a.createElement("div",{style:{width:"88%",overflow:"hidden",textOverflow:"ellipsis"}},e.title),g.a.createElement(wt.a.Item.Brief,null,$n()(e.upload_time).format("MMMM Do YYYY, h:mm a"))),g.a.createElement(kt.a,{type:"ellipsis",style:{position:"absolute",width:"10%",marginTop:-50,right:5,color:"#a8a8a8",zIndex:1},onClick:function(a){n.setState({selectedDocument:e.slug}),n.showModal(t?"uploadedActionModal":"collectedActionModal",a)}}))}},{key:"renderAddDocument",value:function(){var e=this;return g.a.createElement(wt.a.Item,{thumb:g.a.createElement(bn.a,{style:{color:"grey"}}),onClick:function(){return e.finput.click()}},g.a.createElement("div",{style:{color:"grey"}},"New document"),g.a.createElement(wt.a.Item.Brief,null,"Click to upload..."))}},{key:"renderUploadedList",value:function(e){var t=this,n=e.map(function(e){return t.renderListItem(t.props.documents[e],!0)});return g.a.createElement(wt.a,null,this.renderAddDocument(),n)}},{key:"renderCollectedList",value:function(e){var t=this;if(!e.length)return g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,null,g.a.createElement("div",{style:{color:"grey",textAlign:"center"}},"You haven't collected any document.")));var n=e.map(function(e){return t.renderListItem(t.props.documents[e],!1)});return g.a.createElement(wt.a,null,n)}},{key:"renderStickyTab",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement(Gt.a,null),g.a.createElement(dn.StickyContainer,null,g.a.createElement(Jt.a,{tabs:[{title:"Uploaded"},{title:"Collected"}],swipeable:!0,_renderTabBar:this.renderReactSticky},g.a.createElement("div",{style:{justifyContent:"center",height:"100%",backgroundColor:"#fff"}},this.renderUploadedList(y.a.orderBy(this.props.user.uploadedDocuments,function(t){return e.props.documents[t].upload_time},"desc"))),g.a.createElement("div",{style:{justifyContent:"center",height:"100%",backgroundColor:"#fff"}},this.renderCollectedList(y.a.orderBy(this.props.user.collectedDocuments,function(t){return e.props.documents[t].upload_time},"desc"))))),g.a.createElement(Gt.a,null))}},{key:"renderRenameModal",value:function(e){var t=this;return Et.a.prompt("Rename","Enter the new name",[{text:"Cancel"},{text:"Confirm",onPress:function(n){var a=new FormData;a.append("new_title",n),a.append("csrfmiddlewaretoken",Pt("csrftoken")),t.props.renameDocument(e.renameUrl,a)}}],"default",e.title)}},{key:"renderCollectedActionModal",value:function(){var e=this,t=this.props.documents[this.state.selectedDocument];return g.a.createElement(Et.a,{popup:!0,visible:this.state.collectedActionModal,onClose:function(){return e.onClose("collectedActionModal")},animationType:"slide-up"},g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",{style:{color:"#1BA39C"}},t.title)},className:"popup-list"},this.props.match.params.groupUuid?null:g.a.createElement(wt.a.Item,{onClick:function(){e.props.history.push("/add-to-readlists")}},g.a.createElement(bn.a,{style:{height:18,color:"#1BA39C",marginRight:20}}),"Add To Readlist"),this.props.match.params.groupUuid?null:g.a.createElement(wt.a.Item,{onClick:function(){var e=window.location;Nt([e.protocol,"//",e.host,"/documents/",t.slug].join("")),Qt.a.success("Copied to clipboard!",1)}},g.a.createElement(Vn.a,{style:{height:18,color:"#1BA39C",marginRight:20}}),"Share"),g.a.createElement(wt.a.Item,{onClick:function(){Et.a.alert("Uncollect "+t.title+"?","",[{text:"Cancel"},{text:"Uncollect",style:{color:"#FF0000"},onPress:function(){e.onClose("collectedActionModal");var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),e.props.uncollectDocument(t.uncollectUrl,n,t.slug)}}])}},g.a.createElement(Hn.a,{style:{height:18,color:"#e74c3c",marginRight:20}}),g.a.createElement("span",{style:{color:"#e74c3c"}},"Uncollect"))))}},{key:"renderUploadedActionModal",value:function(){var e=this,t=this.props.documents[this.state.selectedDocument];return g.a.createElement(Et.a,{popup:!0,visible:this.state.uploadedActionModal,onClose:function(){return e.onClose("uploadedActionModal")},animationType:"slide-up"},g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",{style:{color:"#1BA39C"}},t.title)},className:"popup-list"},this.props.match.params.groupUuid?null:g.a.createElement(wt.a.Item,{onClick:function(){e.props.history.push("/add-to-readlists/"+t.slug)}},g.a.createElement(bn.a,{style:{height:18,color:"#1BA39C",marginRight:20}}),"Add To Readlist"),this.props.match.params.groupUuid?null:g.a.createElement(wt.a.Item,{onClick:function(){var e=window.location;Nt([e.protocol,"//",e.host,"/documents/",t.slug].join("")),Qt.a.success("Copied to clipboard!",1)}},g.a.createElement(Vn.a,{style:{height:18,color:"#1BA39C",marginRight:20}}),"Share"),g.a.createElement(wt.a.Item,{onClick:function(){e.renderRenameModal(t)}},g.a.createElement(Fn.a,{style:{height:18,color:"#1BA39C",marginRight:20}}),"Rename"),g.a.createElement(wt.a.Item,{onClick:function(){Et.a.alert("Delete "+t.title+"?","",[{text:"Cancel"},{text:"Delete",style:{color:"#FF0000"},onPress:function(){e.onClose("uploadedActionModal");var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),e.props.deleteDocument(t.delete_url,n,t.slug)}}])}},g.a.createElement(Hn.a,{style:{height:18,color:"#e74c3c",marginRight:20}}),g.a.createElement("span",{style:{color:"#e74c3c"}},"Delete"))))}},{key:"renderFileItem",value:function(e){return e?g.a.createElement(Gn.a,{style:{paddingLeft:0,paddingRight:0}},g.a.createElement("img",{src:ta.a,alt:"pdf-icon",style:{height:28,width:24}}),g.a.createElement(Jn.a,{primary:g.a.createElement("div",{style:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}},e.name),secondary:"Modified "+$n()(e.lastModified).format("MMM D, HH:mm")})):g.a.createElement("div",null,"File upload failed!")}},{key:"renderFileNameTextField",value:function(e){var t=this;return e?g.a.createElement(Zn.a,{multiline:!0,margin:"dense",id:"name",label:"Name",defaultValue:e.name.split(".").slice(0,-1).join("."),fullWidth:!0,onChange:function(e){return t.setState({name:e.target.value})}}):g.a.createElement("div",null)}},{key:"renderReadlistSelect",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement(Gn.a,{style:{padding:0},button:!0,divider:!0,"aria-haspopup":"true",onClick:function(t){e.showModal("chooseReadlistRadio",t)}},g.a.createElement(Jn.a,{primary:"Readlist",secondary:this.state.value?this.props.readlists[this.state.value].name:"Click to select... (optional)"})),g.a.createElement(Ln,{open:this.state.chooseReadlistRadio,onClose:this.handleConfirmationDialogClose,value:this.state.value}))}},{key:"renderUploadDialog",value:function(){var e=this,t=this.state.uploadedFile;return g.a.createElement(jn.a,{onClose:function(){e.onClose("uploadDialog"),e.finput.value=""},open:this.state.uploadDialog,"aria-labelledby":"simple-dialog-title"},g.a.createElement(In.a,{id:"simple-dialog-title"},"Upload"),g.a.createElement(Dn.a,null,this.renderFileItem(t),this.renderFileNameTextField(t),!this.props.match.params.groupUuid&&this.renderReadlistSelect()),g.a.createElement(Sn.a,null,g.a.createElement(gn.a,{onClick:function(){e.onClose("uploadDialog"),e.finput.value=""},color:"primary"},"Cancel"),g.a.createElement(gn.a,{onClick:function(){e.onClose("uploadDialog"),e.handleFileSubmit(),e.finput.value=""},color:"primary"},"Upload")))}},{key:"render",value:function(){var e=this;if(this.state.loading)return g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5});if(!this.props.user||!this.props.user.is_authenticated)return g.a.createElement(vn,{history:this.props.history});var t=this.props.coteries[this.props.match.params.groupUuid];return this.props.match.params.groupUuid&&!t?g.a.createElement(yn,null):g.a.createElement("div",null,this.renderStickyTab(),this.renderUploadedActionModal(),this.renderCollectedActionModal(),this.renderUploadDialog(),g.a.createElement("input",{ref:function(t){return e.finput=t},style:{visibility:"hidden"},type:"file",accept:"application/pdf",onChange:Object(Zt.a)(Kt.a.mark(function t(){return Kt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.handleFileDialog());case 1:case"end":return t.stop()}},t,this)}))}))}}]),t}(f.Component);var aa=Object(E.b)(function(e){return{user:e.user,documents:e.documents,coteries:e.coteries,readlists:e.readlists}},a)(na),ra=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={createdReadlistActionModal:!1,collectedReadlistActionModal:!1,selectedReadlist:null,loading:!0},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.match.params.groupUuid?this.setState({loading:!1}):this.props.getMyReadlists().then(function(){e.setState({loading:!1})})}},{key:"renderReactSticky",value:function(e){return g.a.createElement(dn.Sticky,null,function(t){var n=t.style;return g.a.createElement("div",{style:Object(Xt.a)({},n,{zIndex:1})},g.a.createElement(Jt.a.DefaultTabBar,e))})}},{key:"renderAddReadlist",value:function(){var e=this;return this.props.match.params.groupUuid?g.a.createElement("div",null):g.a.createElement(wt.a.Item,{thumb:g.a.createElement(bn.a,{style:{color:"grey"}}),onClick:function(){e.props.history.push("/create-readlist-form")}},g.a.createElement("div",{style:{color:"grey"}},"New readlist"),g.a.createElement(wt.a.Item.Brief,null,"Click to create..."))}},{key:"renderReadlist",value:function(e,t){var n=this;if(this.props.match.params.groupUuid)return g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,null,g.a.createElement("div",{style:{color:"grey",textAlign:"center"}},"Group-based readlists still in development.")));if(!e.length)return g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,null,g.a.createElement("div",{style:{color:"grey",textAlign:"center"}},"You haven't ",t?"created":"collected"," any readlists.")));var a=e.map(function(e){var t=n.props.readlists[e];return g.a.createElement("div",{key:e},g.a.createElement(wt.a.Item,{thumb:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678072-folder-document-512.png",multipleLine:!0,arrow:"horizontal",onClick:function(){n.props.history.push("readlists/".concat(e))}},t.name,g.a.createElement(wt.a.Item.Brief,null,$n()(t.create_time).format("MMMM Do YYYY, h:mm a"))))});return g.a.createElement("div",null,g.a.createElement(wt.a,null,a))}},{key:"renderCreatedReadlists",value:function(){var e=this;return g.a.createElement("div",null,this.renderAddReadlist(),this.renderReadlist(y.a.orderBy(this.props.user.createdReadlists,function(t){return e.props.readlists[t].create_time},"desc"),!0))}},{key:"renderCollectedReadlists",value:function(){var e=this;return g.a.createElement("div",null,this.renderReadlist(y.a.orderBy(this.props.user.collectedReadlists,function(t){return e.props.readlists[t].create_time},"desc"),!1))}},{key:"renderStickyTab",value:function(){return g.a.createElement("div",null,g.a.createElement(Gt.a,null),g.a.createElement(dn.StickyContainer,null,g.a.createElement(Jt.a,{tabs:[{title:"Created"},{title:"Collected"}],initalPage:"t2",_renderTabBar:this.renderReactSticky},g.a.createElement("div",{style:{justifyContent:"center",height:"100%",backgroundColor:"#fff"}},this.renderCreatedReadlists()),g.a.createElement("div",{style:{justifyContent:"center",height:"100%",backgroundColor:"#fff"}},this.renderCollectedReadlists()))),g.a.createElement(Gt.a,null))}},{key:"render",value:function(){if(this.state.loading)return g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5});if(!this.props.user||!this.props.user.is_authenticated)return g.a.createElement(vn,{history:this.props.history});var e=this.props.coteries[this.props.match.params.groupUuid];return this.props.match.params.groupUuid&&!e?g.a.createElement(yn,null):g.a.createElement("div",null,this.renderStickyTab())}}]),t}(f.Component);var oa=Object(E.b)(function(e){return{user:e.user,readlists:e.readlists,coteries:e.coteries}},a)(ra),ia=n(148),sa=n.n(ia),la=n(269),ca=n.n(la),ua=n(144),da=n.n(ua),Aa=n(198),pa=n.n(Aa),ma=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getCombinedNotifications().then(function(){e.props.getInvitations().then(function(){e.setState({loading:!1})})})}},{key:"getActionDescription",value:function(e){return"reply to annotation"===e||"reply to annotation reply"===e?"replied":"post annotation"===e?"posted":e}},{key:"getCoterieName",value:function(e){if(e){e=e.replace(/-/g,"");var t=this.props.coteries[e].name;return console.log(e),t.length>14?t.slice(0,14)+"...":t}return""}},{key:"formatNotificationTime",value:function(e){return $n()(e).isSame($n()(),"day")?$n()(e).format("H:mm"):$n()(e).isSame($n()(),"year")?$n()(e).format("M-d"):$n()(e).format("YYYY-M-d")}},{key:"handleMarkAllAsRead",value:function(){var e=y.a.filter(this.props.notifications,function(e){return!0===e.unread}),t=[];e.map(function(e){t.push(e.slug)});var n=new FormData;n.append("notif_slugs_to_mark_as_read",t.join()),n.append("csrfmiddlewaretoken",Pt("csrftoken")),this.props.markAllNotificationsAsRead(n,t)}},{key:"renderInvitationList",value:function(e){var t=this,n=e.map(function(e){return g.a.createElement(wt.a.Item,{key:e.pk,thumb:g.a.createElement(St.a,{style:{height:50,width:50,backgroundColor:"#1BA39C"}},g.a.createElement(sa.a,{style:{height:40}})),extra:g.a.createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",float:"right"}},g.a.createElement(ca.a,{style:{marginBottom:20,color:"1BA39C"},onClick:function(){Et.a.alert("Accept","Accept invitation to join "+e.coterie_name+"?",[{text:"Cancel"},{text:"Join",style:{color:"#1BA39C"},onPress:function(){var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),t.props.acceptInvitation(e.accept_url,n,e.pk)}}])}}),g.a.createElement(da.a,{style:{color:"red"},onClick:function(){Et.a.alert("Decline","Decline invitation to join "+e.coterie_name+"?",[{text:"Cancel"},{text:"Decline",style:{color:"#FF0000"},onPress:function(){var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),t.props.declineInvitation(e.reject_url,n,e.pk)}}])}})),align:"middle",multipleLine:!0,wrap:!0,style:{backgroundColor:"#edf9f6"},onClick:function(){}},g.a.createElement("b",null,e.inviter_nickname+" invited you to join "+e.coterie_name),g.a.createElement(wt.a.Item.Brief,null,e.invitation_message))});return g.a.createElement("div",null,g.a.createElement(wt.a,{renderHeader:function(){return"Pending invitaions"},style:{textAlign:"left"}},n))}},{key:"renderNotificationsList",value:function(e){var t=this,n=e.map(function(e){var n=["reply to annotation","post annotation","reply to annotation reply"].includes(e.verb);return g.a.createElement(wt.a.Item,{key:e.slug,thumb:n&&e.data?g.a.createElement("img",{src:e.data.image_url,style:{height:50,width:50,borderRadius:"50%"}}):g.a.createElement(St.a,{style:{height:50,width:50,backgroundColor:"#1BA39C"}},g.a.createElement(sa.a,{style:{height:40}})),extra:g.a.createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",float:"right"}},g.a.createElement("span",{style:{marginBottom:10}},t.formatNotificationTime(e.timestamp)),e.unread?g.a.createElement("span",{style:{textAlign:"right",zIndex:1e3},onClick:function(n){t.props.markNotificationAsRead(e.mark_read_url,e.slug),n.stopPropagation()}},g.a.createElement(sa.a,null)):g.a.createElement("span",{style:{textAlign:"right",zIndex:1}},g.a.createElement(pa.a,null))),align:"middle",multipleLine:!0,wrap:!0,style:{backgroundColor:e.unread?"#edf9f6":""},onClick:function(){t.props.markNotificationAsRead(e.mark_read_url,e.slug),n&&e.data&&t.props.history.push(e.data.redirect_url)}},e.unread?g.a.createElement("div",null,g.a.createElement("b",null,e.actor+" "+t.getActionDescription(e.verb)),e.data.coterie_uuid&&g.a.createElement("b",null," in ",g.a.createElement("span",{style:{color:Yt(e.data.coterie_uuid)}},t.getCoterieName(e.data.coterie_uuid)))):g.a.createElement("div",null,e.actor+" "+t.getActionDescription(e.verb),e.data.coterie_uuid&&g.a.createElement("span",null," in ",g.a.createElement("span",{style:{color:Yt(e.data.coterie_uuid)}},t.getCoterieName(e.data.coterie_uuid)))),g.a.createElement(wt.a.Item.Brief,null,e.description))});return g.a.createElement("div",null,g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement(pa.a,{onClick:function(){Et.a.alert("Mark all notifications as read?","",[{text:"Cancel"},{text:"OK",style:{color:"#1BA39C"},onPress:function(){t.handleMarkAllAsRead()}}])}})},style:{textAlign:"center"}},n),g.a.createElement(Gt.a,null))}},{key:"render",value:function(){if(this.state.loading)return g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5});if(!this.props.user||!this.props.user.is_authenticated)return g.a.createElement(vn,{history:this.props.history});if(y.a.isEmpty(this.props.notifications)&&y.a.isEmpty(this.props.invitations))return g.a.createElement("div",null,g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,null,g.a.createElement(wt.a.Item.Brief,null,"You are up to date!"))));var e=y.a.orderBy(this.props.notifications,"timestamp","desc"),t=y.a.orderBy(this.props.invitations,"pk","desc");return g.a.createElement("div",null,0!==t.length&&this.renderInvitationList(t),this.renderNotificationsList(e))}}]),t}(f.Component);var ha=Object(E.b)(function(e){return{user:e.user,notifications:e.notifications,invitations:e.invitations,coteries:e.coteries}},a)(ma),fa=(n(572),n(270)),ga=n.n(fa),va=(n(575),n(149)),ya=n.n(va),Ea=n(117),Ca=n(199),ka=n.n(Ca),ba=n(145),wa=n.n(ba),Ia=n(273),Ba=n.n(Ia),Da=n(274),Oa=n.n(Da),Sa=n(200),xa=n.n(Sa),ja=n(272),Ra=n.n(ja),Ma=n(271),_a=n.n(Ma),Ta=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(t){n.setState(Object(It.a)({},e,t.target.value))}},n.state={isFetching:!0,memberModal:!1,adminModal:!1,inviteDialog:!1,editDialog:!1},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getMyCoteries().then(function(){e.setState({isFetching:!1})})}},{key:"showModal",value:function(e,t){t.preventDefault(),this.setState(Object(It.a)({},e,!0))}},{key:"onClose",value:function(e){this.setState(Object(It.a)({},e,!1))}},{key:"handleFormSubmit",value:function(){var e=this.preprocessEmailsString(this.state.emails),t=Object(Ea.a)(e,2),n=t[0],a=t[1];if(n){var r=new FormData;r.append("coterie_id",this.props.coteries[this.props.match.params.groupUuid].pk),r.append("invitee_emails",a),r.append("invitation_message",this.state.message?this.state.message:"No message"),r.append("csrfmiddlewaretoken",Pt("csrftoken")),this.props.inviteToCoterie(r).then(function(e){var t=e.payload.data.successful_invitations,n=e.payload.data.unregistered_emails;t.length>0&&Qt.a.success("Invitations successfully sent",1),n.length>0&&Qt.a.fail("Following emails are not registered yet: "+n.join("\n"),5)})}else a?Qt.a.fail(a+" is not valid! Verify and try again",2.8):Qt.a.fail("Email input is not valid! Try emails separated by commas",2.8)}},{key:"_emailsStringToArray",value:function(e){var t=e.trim().split(/\n| /),n=[],a=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var l=i.value;n=n.concat(l.trim().split(",").filter(function(e){return""!==e}))}}catch(c){r=!0,o=c}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}},{key:"_handleCopyPasteEmailsFromEmailClient",value:function(e){var t=[],n=e.match(/<.+?>/g);for(var a in n){var r=n[a].replace("<","").replace(">","");ka.a.validate(r)&&!t.includes(r)&&t.push(r)}return t}},{key:"preprocessEmailsString",value:function(e){var t=this._handleCopyPasteEmailsFromEmailClient(e);if(0!=t.length)return[!0,t.join(",")];var n=this._emailsStringToArray(e),a=[],r=!0,o=!1,i=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;if(c=c.trim(),!ka.a.validate(c))return[!1,[c]];a.includes(c)||a.push(c)}}catch(u){o=!0,i=u}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return[!0,a.join(",")]}},{key:"handleGroupEdit",value:function(e){var t=this,n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),this.state.new_name&&this.state.new_name!==e.name&&n.append("new_name",this.state.new_name),this.state.new_desc&&this.state.new_desc!==e.description&&n.append("new_desc",this.state.new_desc),this.props.updateCoterie(n,e.pk).then(function(n){t.props.updateCoterieSuccess(e.uuid,t.state.new_name,t.state.new_desc)})}},{key:"renderMember",value:function(e,t){var n=this,a=this.props.user.administratedCoteries.includes(t.uuid);return g.a.createElement(wt.a.Item,{key:e.pk,thumb:g.a.createElement("img",{src:e.portrait_url,alt:"ortrait",style:{borderRadius:"50%"}}),align:"middle",extra:a&&g.a.createElement(da.a,{style:{color:"red"},onClick:function(){Et.a.alert("Remove member "+e.nickname+"?","",[{text:"Cancel"},{text:"Remove",style:{color:"#FF0000"},onPress:function(){var a=new FormData;a.append("csrfmiddlewaretoken",Pt("csrftoken")),a.append("member_email_address",e.email_address),n.props.removeMember(t.remove_member_url,a,t.uuid,e.email_address)}}])}})},e.nickname)}},{key:"renderAdmin",value:function(e){return g.a.createElement(wt.a.Item,{key:e.pk,thumb:g.a.createElement("img",{src:e.portrait_url,alt:"ortrait",style:{borderRadius:"50%"}})},e.nickname)}},{key:"renderGroupInfo",value:function(e){var t=this,n=this.props.user.administratedCoteries.includes(e.uuid);return g.a.createElement(ga.a,{size:"lg"},g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement(ya.a,null,g.a.createElement(ya.a.Header,{title:g.a.createElement("span",{style:{marginLeft:20}},e.name),thumb:g.a.createElement(Rt.a,{style:{color:"rgb(101, 119, 134)"}}),extra:n&&g.a.createElement(wa.a,{onClick:function(e){t.showModal("editDialog",e)}})}),g.a.createElement(ya.a.Body,null,g.a.createElement("div",null,e.description))),g.a.createElement(Gt.a,{size:"lg"}))}},{key:"renderMemberModal",value:function(e){var t=this;return g.a.createElement(Et.a,{popup:!0,visible:this.state.memberModal,onClose:function(){return t.onClose("memberModal")},animationType:"slide-up",style:{overflow:"auto",maxHeight:"80vh"}},g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",{style:{color:"#1BA39C"}},"Members")},className:"popup-list"},e.members.map(function(n){return t.renderMember(n,e)})))}},{key:"renderAdminModal",value:function(e){var t=this;return g.a.createElement(Et.a,{popup:!0,visible:this.state.adminModal,onClose:function(){return t.onClose("adminModal")},animationType:"slide-up",style:{overflow:"auto",maxHeight:"80vh"}},g.a.createElement(wt.a,{renderHeader:function(){return g.a.createElement("b",{style:{color:"#1BA39C"}},"Administrators")},className:"popup-list"},e.administrators.map(function(e){return t.renderAdmin(e)})))}},{key:"renderInviteDialog",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement(jn.a,{open:this.state.inviteDialog,onClose:function(){return e.onClose("inviteDialog")},"aria-labelledby":"form-dialog-title"},g.a.createElement(In.a,{id:"form-dialog-title"},"Invite new members"),g.a.createElement(Dn.a,null,g.a.createElement(_a.a,null,"To invite new members to the group, enter their email addresses here, separated by commas. (Alternatively, you can copy paste the emails directly from your email client - we will detect emails within < >). We will send invitation messages."),g.a.createElement(Zn.a,{required:!0,autoFocus:!0,multiline:!0,margin:"dense",id:"emails",label:"Email Address",type:"email",fullWidth:!0,onChange:this.handleChange("emails")}),g.a.createElement(Zn.a,{multiline:!0,margin:"dense",id:"message",label:"Message",fullWidth:!0,onChange:this.handleChange("message")})),g.a.createElement(Sn.a,null,g.a.createElement(gn.a,{onClick:function(){return e.onClose("inviteDialog")},color:"primary"},"Cancel"),g.a.createElement(gn.a,{disabled:y.a.isEmpty(this.state.emails),onClick:function(){e.onClose("inviteDialog"),e.handleFormSubmit()},color:"primary"},"Send"))))}},{key:"renderEditDialog",value:function(e){var t=this;return g.a.createElement("div",null,g.a.createElement(jn.a,{open:this.state.editDialog,onClose:function(){return t.onClose("editDialog")},"aria-labelledby":"form-dialog-title"},g.a.createElement(In.a,{id:"form-dialog-title"},"Edit Group Info"),g.a.createElement(Dn.a,null,g.a.createElement(Zn.a,{autoFocus:!0,multiline:!0,margin:"dense",id:"new_name",label:"New name",defaultValue:e.name,fullWidth:!0,onChange:this.handleChange("new_name")}),g.a.createElement(Zn.a,{multiline:!0,margin:"dense",id:"new_desc",label:"New description",defaultValue:e.description,fullWidth:!0,onChange:this.handleChange("new_desc")})),g.a.createElement(Sn.a,null,g.a.createElement(gn.a,{onClick:function(){return t.onClose("editDialog")},color:"primary"},"Cancel"),g.a.createElement(gn.a,{onClick:function(){t.onClose("editDialog"),t.handleGroupEdit(e)},color:"primary"},"Send"))))}},{key:"render",value:function(){var e=this;if(this.state.isFetching)return g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5});if(!this.props.user||!this.props.user.is_authenticated)return g.a.createElement(vn,{history:this.props.history});var t=this.props.coteries[this.props.match.params.groupUuid];if(this.props.match.params.groupUuid&&!t)return g.a.createElement(yn,null);if(!this.props.match.params.groupUuid)return g.a.createElement("h2",{style:{color:"grey"}}," You are in the public group. ");var n=this.props.user.administratedCoteries.includes(t.uuid);return g.a.createElement("div",null,this.renderGroupInfo(t),g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,{thumb:g.a.createElement(Ra.a,{style:{color:"orange"}}),extra:t.administrators.length,arrow:"horizontal",onClick:function(t){e.showModal("adminModal",t)}},"Administrators"),g.a.createElement(wt.a.Item,{thumb:g.a.createElement(Ba.a,{style:{color:"42A5F5"}}),extra:t.members.length,arrow:"horizontal",onClick:function(t){e.showModal("memberModal",t)}},"Members"),n&&g.a.createElement(wt.a.Item,{thumb:g.a.createElement(Oa.a,{style:{color:"#1BA39C"}}),onClick:function(t){e.showModal("inviteDialog",t)}},"Add someone")),g.a.createElement(Gt.a,{size:"lg"}),!n&&g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,{thumb:g.a.createElement(xa.a,{style:{color:"#FF0000"}}),onClick:function(){Et.a.alert("Leave "+t.name+"?","Are you sure to exit this group? This cannot be undone",[{text:"Cancel"},{text:"Leave",style:{color:"#FF0000"},onPress:function(){var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),e.props.leaveCoterie(n,t.pk,t.uuid),e.props.history.push("/explore")}}])}},"Leave group")),n&&g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,{thumb:g.a.createElement(xa.a,{style:{color:"#FF0000"}}),onClick:function(){Et.a.alert("Delete "+t.name+"?","Are you sure? Deleting the group can affect all existing members. This cannot be undone",[{text:"Cancel"},{text:"Leave",style:{color:"#FF0000"},onPress:function(){var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),e.props.deleteCoterie(n,t.pk,t.uuid),e.props.history.push("/explore")}}])}},"Delete group")),this.renderAdminModal(t),this.renderMemberModal(t),this.renderInviteDialog(),this.renderEditDialog(t))}}]),t}(f.Component);var Qa=Object(E.b)(function(e){return{user:e.user,coteries:e.coteries}},a)(Ta),Pa=function(e){var t=e.match;return g.a.createElement(s.a,null,g.a.createElement(l.a,{path:"".concat(t.url,"/:groupUuid?/explore"),component:Cn}),g.a.createElement(l.a,{path:"".concat(t.url,"/:groupUuid?/uploads"),component:aa}),g.a.createElement(l.a,{path:"".concat(t.url,"/:groupUuid?/readlists"),component:oa}),g.a.createElement(l.a,{path:"".concat(t.url,"/:groupUuid?/notifications"),component:ha}),g.a.createElement(l.a,{path:"".concat(t.url,"/:groupUuid?/settings"),component:Qa}))},Na=function(){return g.a.createElement("main",null,g.a.createElement(s.a,null,g.a.createElement(l.a,{path:"/groups",component:Pa}),g.a.createElement(l.a,{path:"/explore",component:pn}),g.a.createElement(l.a,{path:"/uploads",component:aa}),g.a.createElement(l.a,{path:"/readlists",component:oa}),g.a.createElement(l.a,{path:"/notifications",component:ha}),g.a.createElement(l.a,{path:"/settings",component:Qa})))},La=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getMyCoteries().then(function(){e.setState({loading:!1})}),this.props.getCombinedNotifications(),this.props.getInvitations()}},{key:"render",value:function(){return y.a.isEmpty(this.props.user)||this.state.loading?g.a.createElement(an.a,{container:!0,justify:"center",alignItems:"center",wrap:"nowrap",style:{height:"95vh"}},g.a.createElement($t.a,{style:{color:"#1BA39C"},size:"10vw",thickness:5})):g.a.createElement("div",{className:"App"},g.a.createElement(Ht,{path:this.props.location.pathname,history:this.props.history,match:this.props.match}),g.a.createElement(mt,{path:this.props.location.pathname,history:this.props.history,content:g.a.createElement(Na,null)}))}}]),t}(f.Component);var Ya=Object(E.b)(function(e){return{user:e.user,coteries:e.coteries}},a)(La),Fa=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.user&&this.props.user.isAuthenticated||this.props.getUser()}},{key:"render",value:function(){return this.props.children}}]),t}(g.a.Component);var Ua=Object(E.b)(function(e){return{user:e.user}},a)(Fa),Ha=(n(184),n(101)),za=n.n(Ha),Ga=(n(186),n(102)),Wa=n.n(Ga),Ja=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={coterie_name:"",coterie_description:""},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"handleSubmit",value:function(){var e=this,t=this.state,n=t.coterie_name,a=t.coterie_description,r=new FormData;r.append("coterie_name",n),r.append("coterie_description",a),r.append("csrfmiddlewaretoken",Pt("csrftoken")),this.props.createCoterie(r).then(function(t){var n=t.payload.data;e.props.history.push("/groups/".concat(n.uuid,"/settings")),Qt.a.success("You are now in the group "+n.name,2)})}},{key:"render",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",color:"#1BA39C"}),onLeftClick:function(){return e.props.history.goBack()}},"Create Group"),g.a.createElement(wt.a,{renderHeader:function(){return"You will be the administrator upon creation"}},g.a.createElement(Wa.a,{clear:!0,placeholder:"Name of the group",onChange:function(t){return e.setState({coterie_name:t})}},"Name")),g.a.createElement(wt.a,{renderHeader:function(){return"Description"}},g.a.createElement(za.a,{rows:5,count:100,onChange:function(t){return e.setState({coterie_description:t})}}),g.a.createElement(wt.a.Item,null,g.a.createElement(vt.a,{disabled:0===this.state.coterie_name.length,type:"primary",style:{backgroundColor:"#1BA39C"},onClick:function(){return e.handleSubmit()}},"Create"))))}}]),t}(f.Component);var Xa=Object(E.b)(function(e){return{}},a)(Ja),Va=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={readlist_name:"",readlist_description:""},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"handleSubmit",value:function(){var e=this.state,t=e.readlist_name,n=e.readlist_description,a=new FormData;a.append("readlist_name",t),a.append("description",n),a.append("csrfmiddlewaretoken",Pt("csrftoken")),this.props.createReadlist(a),this.props.history.goBack()}},{key:"render",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",color:"#1BA39C"}),onLeftClick:function(){return e.props.history.goBack()}},"Create Readlist"),g.a.createElement(wt.a,null,g.a.createElement(Wa.a,{clear:!0,placeholder:"Name of the readlist",onChange:function(t){return e.setState({readlist_name:t})}},"Name")),g.a.createElement(wt.a,{renderHeader:function(){return"Description"}},g.a.createElement(za.a,{rows:5,count:100,onChange:function(t){return e.setState({readlist_description:t})}}),g.a.createElement(wt.a.Item,null,g.a.createElement(vt.a,{disabled:0===this.state.readlist_name.length,type:"primary",style:{backgroundColor:"#1BA39C"},onClick:function(){return e.handleSubmit()}},"Create"))))}}]),t}(f.Component);var Ka=Object(E.b)(function(e){return{}},a)(Va),Za=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={readlist_name:"",readlist_description:""},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.slug;this.props.getReadlist(t).then(function(){e.setState({readlist_name:e.props.readlists.readlist.name,readlist_description:e.props.readlists.readlist.description})})}},{key:"handleSubmit",value:function(){var e=this,t=this.state,n=t.readlist_name,a=t.readlist_description,r=new FormData;r.append("new_name",n),r.append("new_desc",a),r.append("csrfmiddlewaretoken",Pt("csrftoken")),this.props.editReadlist(this.props.readlists.readlist.rename_url,r).then(function(){e.props.editReadlist(e.props.readlists.readlist.change_desc_url,r)}).then(function(){e.props.history.goBack()})}},{key:"handleDelete",value:function(){var e=this,t=this.props.readlists.readlist;Et.a.alert("Delete "+this.state.readlist_name+"?","All followers and you will no longer have access",[{text:"Cancel"},{text:"Delete",style:{color:"#FF0000"},onPress:function(){var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),e.props.deleteReadlist(t.delete_url,n,t.slug),e.props.history.push("/readlists")}}])}},{key:"render",value:function(){var e,t=this;return g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",color:"#1BA39C"}),onLeftClick:function(){return t.props.history.goBack()}},"Edit Readlist"),g.a.createElement(Gt.a,null),g.a.createElement(Gt.a,null),g.a.createElement(wt.a,null,g.a.createElement(Wa.a,{clear:!0,placeholder:"Name of the readlist",value:this.state.readlist_name,onChange:function(e){return t.setState({readlist_name:e})}},"Name")),g.a.createElement(wt.a,{renderHeader:function(){return"Description"}},g.a.createElement(za.a,{rows:5,count:100,value:this.state.readlist_description,onChange:function(e){return t.setState({readlist_description:e})}}),g.a.createElement(wt.a.Item,null,g.a.createElement(vt.a,{disabled:0===this.state.readlist_name.length,type:"primary",style:{backgroundColor:"#1BA39C"},onClick:function(){return t.handleSubmit()}},"Edit")),g.a.createElement(wt.a.Item,null,g.a.createElement(vt.a,(e={type:"danger"},Object(It.a)(e,"type","primary"),Object(It.a)(e,"style",{backgroundColor:"#e74c3c"}),Object(It.a)(e,"onClick",function(){return t.handleDelete()}),e),"Delete"))))}}]),t}(f.Component);var qa=Object(E.b)(function(e){return{readlists:e.readlists}},a)(Za),$a=(n(594),n(275)),er=n.n($a),tr=n(64);n(597);function nr(e){return Array(e-0).fill().map(function(e,t){return 0+t})}function ar(){window.hasOwnProperty("MathJax")&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}function rr(e,t){if(void 0!==e&&void 0!==t){var n=e.page_index,a=t[n],r=a.indexOf(e);if(r>0)return a[r-1];var o=function(e,t){for(var n=e-1;;){if(n<1)return;if(t[n].length>0)return n;n-=1}}(n,t);if(void 0!==o){var i=t[o];return i[i.length-1]}}}function or(e,t,n){if(void 0!==e&&void 0!==t&&void 0!==n){var a=e.page_index,r=t[a],o=r.indexOf(e);if(o<r.length-1)return r[o+1];var i=function(e,t,n){for(var a=e+1;;){if(a>n)return;if(t[a].length>0)return a;a+=1}}(a,t,n);if(void 0!==i)return t[i][0]}}var ir=n(283),sr=n.n(ir),lr=n(192),cr=n.n(lr),ur=n(277),dr=n.n(ur),Ar=n(278),pr=n.n(Ar),mr=n(150),hr=n.n(mr),fr=n(23),gr=n.n(fr),vr=n(53),yr=n.n(vr),Er=n(276),Cr=Object(Dt.withStyles)({root:{height:"20px",margin:"5px"},avatar:{height:"20px",width:"20px"}})(cr.a),kr=Object(Dt.withStyles)({root:{minWidth:0}})(gn.a);function br(e){var t,n,a,r,o=!!e.annotator,i=o?e.annotator:e.replier,s=i.pk;return t=i.nickname?i.nickname:"Anonymous",n=i.portrait_url?i.portrait_url:"/media/portrait/anonymous_portrait.png",null===e.edit_time?(a="posted",r=e.post_time):(a="edited",r=e.edit_time),{nickname:t,portrait_url:n,prefix:a,timeago:r,content:e.content,uuid:e.uuid,pk:e.pk,numReplies:e.replies?e.replies.length:0,isAnnotation:o,authorpk:s}}var wr=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={commentMenuElement:null,commentMenuUuid:null},n.openContextMenu=function(e,t,a){n.setState({commentMenuElement:e.currentTarget,selectedComment:t,selectedCommentIsReply:!a})},n.closeContextMenu=function(e){n.setState({commentMenuElement:null,selectedComment:null})},n.locateComment=function(e){e.scrollIntoView({behavior:"smooth"})},n.replyAnnotation=function(e){n.props.setParentState({replyToAnnotationReplyId:null,replyToAnnotationReplyUuid:null,annotationOpen:!1,annotationLinearLinkedListOpen:!0})},n.replyReply=function(e){n.props.setParentState({replyToAnnotationReplyId:e.pk,replyToAnnotationReplyUuid:e.uuid,annotationOpen:!1,annotationLinearLinkedListOpen:!0})},n.likeAnnotation=function(e){var t=new FormData;t.append("csrfmiddlewaretoken",Pt("csrftoken")),t.append("operation","like_annotation"),t.append("annotation_id",e.pk),k.a.post(window.location.pathname+"/",t).then(function(t){n.setState({likeSet:n.state.likeSet.add(e.uuid)})})},n.likeReply=function(e){var t=new FormData;t.append("csrfmiddlewaretoken",Pt("csrftoken")),t.append("operation","like_annotation_reply"),t.append("annotation_reply_id",e.pk),k.a.post(window.location.pathname+"/",t).then(function(t){n.setState({likeSet:n.state.likeSet.add(e.uuid)})})},n.editComment=function(){n.closeContextMenu(),n.props.setParentState({annotationOpen:!1,editCommentOpen:!0,editTextContent:n.state.selectedComment.content,selectedComment:n.state.selectedComment})},n.shareComment=function(){var e=[window.location.protocol,"//",window.location.host,window.location.pathname].join("")+"?annotation="+n.state.selectedComment.uuid;Nt(e),console.log(e),n.closeContextMenu()},n.deleteComment=function(){var e=n.state.selectedCommentIsReply?"delete_annotation_reply":"delete_annotation",t=n.state.selectedCommentIsReply?"reply_id":"annotation_id",a=(parseInt(n.state.selectedComment.page_index),new FormData);a.append("csrfmiddlewaretoken",Pt("csrftoken")),a.append("operation",e),a.append(t,n.state.selectedComment.pk),a.append("document_id",n.props.pdfDocument.pk),console.log(n.state.selectedComment);var r=n.props.selectedAnnotation,o=n.props.annotations,i=n.props.annotationsByPage,s=n.state.selectedComment;k.a.post(window.location.pathname+"/",a).then(function(e){if(console.log(e),console.log(o),console.log(i),n.state.selectedCommentIsReply){var t=0;r.replies.map(function(e){e.uuid==s.uuid&&(r.replies.splice(t,1),o[r.uuid]=r,n.props.setParentState({annotations:o})),t++})}else{delete o[r.uuid];t=0;i[r.page_index].map(function(e){e.uuid==r.uuid&&(i[r.page_index].splice(t,1),n.props.setParentState({annotations:o,annotationsByPage:i,annotationOpen:!1,selectedAnnotation:void 0})),t++})}}),n.closeContextMenu()},n.state.likeSet=new Set,n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"commentBlock",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g.a.createElement("div",{key:e.uuid,className:n?"comment-head":"comment-body"},g.a.createElement(an.a,null,g.a.createElement(an.a,{container:!0,justify:"flex-start",alignItems:"center",wrap:"nowrap"},g.a.createElement(an.a,{item:!0},g.a.createElement(Cr,{label:e.nickname,avatar:g.a.createElement(St.a,{src:e.portrait_url})})),g.a.createElement(an.a,{item:!0},g.a.createElement(yr.a,{variant:"caption"},e.prefix," ",g.a.createElement(tn.a,{date:e.timeago})))),g.a.createElement(an.a,null,g.a.createElement("div",{className:"comment-text",dangerouslySetInnerHTML:{__html:e.content}})),g.a.createElement(an.a,{container:!0,justify:"space-between",alignItems:"center",wrap:"nowrap"},g.a.createElement(an.a,{container:!0,justify:"flex-start",alignItems:"center",wrap:"nowrap"},n&&g.a.createElement(Cr,{icon:g.a.createElement(dr.a,null),label:e.numReplies+(1===e.numReplies?" reply":" replies"),variant:"outlined"})),g.a.createElement(an.a,{container:!0,justify:"flex-end",alignItems:"center",wrap:"nowrap"},n&&g.a.createElement(an.a,{item:!0},g.a.createElement(kr,{color:"primary",onClick:function(){t.locateComment(t.props.annotationArea)}},g.a.createElement(xt.a,{icon:Bt.c}))),g.a.createElement(an.a,{item:!0},g.a.createElement(kr,{color:"primary",onClick:function(){n?t.replyAnnotation(e):t.replyReply(e)}},g.a.createElement(xt.a,{icon:Bt.f}))),g.a.createElement(an.a,{item:!0},g.a.createElement(kr,{color:"primary",style:{color:"#1BA39C"},disabled:this.state.likeSet.has(e.uuid),onClick:function(){n?t.likeAnnotation(e):t.likeReply(e)}},g.a.createElement(xt.a,{icon:this.state.likeSet.has(e.uuid)?Bt.g:Er.a}))),g.a.createElement(an.a,{item:!0},g.a.createElement(kr,{color:"primary",onClick:function(a){return t.openContextMenu(a,e,n)}},g.a.createElement(xt.a,{icon:Bt.a})))))))}},{key:"componentDidMount",value:function(){ar()}},{key:"render",value:function(){var e=this;ar();var t=this.state.commentMenuElement,n=Boolean(t),a=this.props.selectedAnnotation;return g.a.createElement("div",null,this.commentBlock(br(a),!0),a.replies.map(function(t){return e.commentBlock(br(t))}),g.a.createElement(pr.a,{className:"menu",anchorEl:t,open:n,onClose:this.closeContextMenu,PaperProps:{style:{maxHeight:216}}},this.state.selectedComment&&this.props.user.pk==this.state.selectedComment.authorpk&&g.a.createElement(hr.a,{onClick:this.editComment},g.a.createElement(kr,{color:"primary"},g.a.createElement(xt.a,{icon:Bt.e})),g.a.createElement(yr.a,null,"Edit")),g.a.createElement(hr.a,{onClick:this.shareComment},g.a.createElement(kr,{color:"primary"},g.a.createElement(xt.a,{icon:Bt.b})),g.a.createElement(yr.a,null,"Share link")),this.state.selectedComment&&this.props.user.pk==this.state.selectedComment.authorpk&&g.a.createElement(hr.a,{onClick:this.deleteComment},g.a.createElement(kr,{color:"primary"},g.a.createElement(xt.a,{icon:Bt.i})),g.a.createElement(yr.a,null,"Delete"))))}}]),t}(g.a.Component);var Ir=Object(E.b)(function(e){return{user:e.user,coteries:e.coteries}},a)(wr),Br=n(284),Dr=n.n(Br),Or=n(118),Sr=n.n(Or),xr=n(191),jr=n.n(xr),Rr=function(e){function t(e,n){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e,n))).state={value:0,content:void 0},a.onClick=function(){a.props.clickCallback()},a}return Object(h.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.theme;n.transitions.duration.enteringScreen,n.transitions.duration.leavingScreen;return g.a.createElement(jr.a,{in:this.props.show},g.a.createElement(gn.a,{variant:"fab",className:t.fab+" scan-receipt-btn",style:{position:"fixed",bottom:60,zIndex:1e3,backgroundColor:this.props.color},onClick:this.onClick},this.props.icon))}}]),t}(g.a.Component),Mr=Object(Dt.withStyles)(function(e){return{root:{position:"relative",minHeight:200},fab:{position:"absolute",bottom:2*e.spacing.unit,right:2*e.spacing.unit}}},{withTheme:!0})(Rr),_r=n(280),Tr=n.n(_r),Qr=n(282),Pr=n.n(Qr),Nr=n(281),Lr=n.n(Nr),Yr=n(295),Fr=n(201),Ur=n.n(Fr),Hr=n(66),zr=n.n(Hr);Ft.b.add(Bt.d,Bt.h);var Gr="RENDERING",Wr=8,Jr=8,Xr=Et.a.alert,Vr=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).pdfDoc=void 0,n.taskList=[],n.finishList=[],n.rendering=!1,n.clearnessLevel=3.8,n.currentPageIndex=1,n.annotationAreas={},n.prevScroll=window.pageYOffset,n.annotationFirstTouch=!1,n.state={document:{title:""},loading:!0,numPages:0,currentScale:1,scaleFactor:1.08,sampleWidth:void 0,sampleHeight:void 0,annotations:{},annotationsByPage:{},annotationOpen:!1,annotationLinearLinkedListOpen:!1,editCommentOpen:!1,newAnnotationInputOpen:!1,selectedAnnotation:void 0,mode:"view",showFloatButton:!0,creatingAnnotationAtPageIndex:void 0,newAnnotationContent:"",newAnnotationReplyContent:"",editTextContent:""},n.dynamicRenderOnScroll=function(){var e=Math.ceil(window.pageYOffset/n.viewerWrappper.scrollHeight*n.state.numPages);if(e!==n.currentPageIndex){n.currentPageIndex=e;for(var t=nr(9).map(function(e){return!0}),a=0,r=0;r<n.finishList.length;r++)if(n.finishList[a]-e>=-2&&n.finishList[a]-e<=6)t[n.finishList[a]-(e-2)]=!1,a+=1;else{var o=document.getElementById("page-canvas-"+n.finishList[a]);o.width=0,o.height=0,n.finishList.splice(a,1)}n.taskList.splice(1);for(r=0;r<t.length;r++)t[r]&&n.pushNewPageRenderingTask(e-2+r);n.rendering||n.renderTaskList()}},n.handleScroll=function(){n.dynamicRenderOnScroll();var e=window.pageYOffset;e-n.prevScroll>8?n.setState({showFloatButton:!1}):n.prevScroll-e>8&&n.setState({showFloatButton:!0}),n.prevScroll=e},n.pushNewPageRenderingTask=function(e){e>=1&&e<=n.state.numPages&&n.taskList.push({pageIndex:e,status:Gr,taskObj:null})},n.renderTaskList=function(){if(!(n.taskList.length<=0)){n.rendering=!0;var e=n.state.currentScale,t=n.clearnessLevel,a=n.taskList[0].pageIndex,r=Object(tr.a)(Object(tr.a)(n));n.pdfDoc.getPage(a).then(function(n){var o=document.getElementById("page-canvas-"+a);if(null!==o){var i=o.getContext("2d"),s=n.getViewport(t*e);o.height=s.height,o.width=s.width,o.style.height=s.height/t+"px",o.style.width=s.width/t+"px";var l={canvasContext:i,viewport:s};r.taskList[0].status=Gr,r.taskList[0].taskObj=n.render(l),r.taskList[0].taskObj.promise.then(function(){r.taskList.shift(),r.finishList.push(a),r.rendering=!1,r.renderTaskList()})}})}},n.renderAnnotationAreas=function(e){var t,a;k.a.get((t=n.props.match.params.slug,a=n.props.isGroupDocument,a?"/coteries/api/coteriedocuments/byslug/"+t+"/annotations":"/file_viewer/api/documents/byslug/"+t+"/annotations")).then(function(t){for(var a=t.data,r={},o={},i=1;i<=e;i++)r[i]=[];var s=!0,l=!1,c=void 0;try{for(var u,d=a[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var A=u.value;r[parseInt(A.page_index)].push(A),o[A.uuid]=A}}catch(p){l=!0,c=p}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}n.setState({annotations:o,annotationsByPage:r}),console.log(o),console.log(r),n.scrollToTargetAnnotationIfInUrl()})},n.configSizeAccordingToLastPageAndRenderTheFirstSeveralPages=function(e){var t=Object(tr.a)(Object(tr.a)(n));e.getPage(e.numPages).then(function(e){var n=1*window.innerWidth/e.getViewport(1).width;t.setState({currentScale:n,sampleWidth:e.getViewport(n).width,sampleHeight:e.getViewport(n).height}),t.pushNewPageRenderingTask(1),t.pushNewPageRenderingTask(2),t.pushNewPageRenderingTask(3),t.pushNewPageRenderingTask(4),t.renderTaskList()})},n.styleDrawer=function(){void 0!==n.annotationWrapper&&(n.annotationWrapper.parentElement.classList.contains("annotation-drawer")||n.annotationWrapper.parentElement.classList.add("annotation-drawer"))},n.selectAnnotation=function(e){void 0!==n.state.selectedAnnotation&&n.annotationAreas[n.state.selectedAnnotation.uuid].classList.remove("highlighted-annotation-area"),n.setState({selectedAnnotation:n.state.annotations[e]}),n.annotationAreas[e].classList.add("highlighted-annotation-area");var t=n.annotationAreas[e].style.background;n.annotationAreas[e].style.borderColor=t.split(",").slice(0,3).join(",")+", 0.38)",n.state.annotationOpen||(n.styleDrawer(),n.setState({annotationOpen:!0,annotationLinearLinkedListOpen:!1,editCommentOpen:!1}))},n.deselectAnnotation=function(){void 0!==n.state.selectedAnnotation&&n.annotationAreas[n.state.selectedAnnotation.uuid].classList.remove("highlighted-annotation-area"),n.setState({annotationOpen:!1}),n.setState({selectedAnnotation:void 0})},n.lockScroll=function(e){1===e.targetTouches.length&&e.preventDefault()},n.changeToCommentMode=function(){n.setState({mode:"comment"}),document.getElementsByTagName("BODY")[0].addEventListener("touchmove",n.lockScroll,{passive:!1})},n.changeToViewMode=function(){n.setState({mode:"view",creatingAnnotationAtPageIndex:void 0,newAnnotationInputOpen:!1}),document.getElementsByTagName("BODY")[0].removeEventListener("touchmove",n.lockScroll)},n.postAnnotation=function(){if(!(n.state.newAnnotationWidth<Wr||n.state.newAnnotationHeight<Jr)){var e=new FormData;e.append("csrfmiddlewaretoken",Pt("csrftoken")),e.append("operation","annotate"),e.append("page_id","page_id_"+n.state.creatingAnnotationAtPageIndex),e.append("annotation_content",n.state.newAnnotationContent),e.append("top_percent",n.state.newAnnotationY/n.state.sampleHeight),e.append("left_percent",n.state.newAnnotationX/n.state.sampleWidth),e.append("height_percent",n.state.newAnnotationHeight/n.state.sampleHeight),e.append("width_percent",n.state.newAnnotationWidth/n.state.sampleWidth),e.append("frame_color",window.getComputedStyle(document.getElementById("annotation-being-created"),null).getPropertyValue("background-color")),e.append("document_id",n.state.document.pk),e.append("is_public",!0),k.a.post(window.location.pathname+"/",e).then(function(e){var t=e.data.new_annotation_json,a=n.state.annotationsByPage,r=n.state.annotations;a[parseInt(t.page_index)].push(t),r[t.uuid]=t,n.setState({annotations:r,annotationsByPage:a,newAnnotationContent:"",mode:"view",creatingAnnotationAtPageIndex:void 0,newAnnotationInputOpen:!1}),document.getElementsByTagName("BODY")[0].removeEventListener("touchmove",n.lockScroll)}).catch(function(e){Xr("","You need to login to post",[{text:"Cancel",onPress:function(){n.setState({newAnnotationContent:"",mode:"view",creatingAnnotationAtPageIndex:void 0,newAnnotationInputOpen:!1})}},{text:"Go login",onPress:function(){return n.props.history.push("/sign-in")}}])})}},n.cancelCurrentAnnotation=function(){n.setState({creatingAnnotationAtPageIndex:void 0,newAnnotationInputOpen:!1})},n.postAnnotationReply=function(){var e=new FormData;console.log(n.state.replyToAnnotationReplyId),e.append("csrfmiddlewaretoken",Pt("csrftoken")),e.append("operation","reply_annotation"),e.append("annotation_reply_content",n.state.newAnnotationReplyContent),e.append("reply_to_annotation_id",n.state.selectedAnnotation.pk),n.state.replyToAnnotationReplyId&&e.append("reply_to_annotation_reply_id",n.state.replyToAnnotationReplyId),e.append("document_id",n.state.document.pk),e.append("is_public",!0),k.a.post(window.location.pathname+"/",e).then(function(e){var t=n.state.annotations;t[n.state.selectedAnnotation.uuid].replies.push(e.data.new_annotationreply_json),n.setState({annotations:t,newAnnotationReplyContent:"",annotationOpen:!0,annotationLinearLinkedListOpen:!1})}).catch(function(e){Xr("","You need to login to post",[{text:"Cancel",onPress:function(){n.setState({newAnnotationReplyContent:"",annotationOpen:!0,annotationLinearLinkedListOpen:!1})}},{text:"Go login",onPress:function(){return n.props.history.push("/sign-in")}}])})},n.cancelCurrentAnnotationReply=function(){n.setState({annotationOpen:!0,annotationLinearLinkedListOpen:!1})},n.postEdit=function(){var e="/"+window.location.pathname.split("/")[1]+(n.state.selectedComment.isAnnotation?"/api/annotations/":"/api/annotationreplies/")+n.state.selectedComment.pk+"/edit";console.log(e);var t=new FormData;t.append("csrfmiddlewaretoken",Pt("csrftoken")),t.append("new_content",n.state.editTextContent),k.a.post(e,t).then(function(e){var t=n.state.annotations;if(n.state.selectedComment.isAnnotation)t[n.state.selectedAnnotation.uuid].content=n.state.editTextContent;else for(var a=0;a<t[n.state.selectedAnnotation.uuid].replies.length;a++)if(t[n.state.selectedAnnotation.uuid].replies[a].uuid==n.state.selectedComment.uuid){t[n.state.selectedAnnotation.uuid].replies[a].content=n.state.editTextContent;break}n.setState({annotationOpen:!0,editCommentOpen:!1,annotations:t})})},n.cancelEdit=function(){n.setState({annotationOpen:!0,editCommentOpen:!1})},n.scrollToTargetAnnotationIfInUrl=function(){var e,t,a=(e="annotation",new URL(window.location.href).searchParams.get(e));if(null!=a){if(a=(t=a).slice(0,8)+"-"+t.slice(8,12)+"-"+t.slice(12,16)+"-"+t.slice(16,20)+"-"+t.slice(20,32),void 0===n.annotationAreas[a])return;n.selectAnnotation(a),n.annotationAreas[a].scrollIntoView({block:"start",behavior:"smooth"})}},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e,t,n=this;k.a.get((e=this.props.match.params.slug,t=this.props.isGroupDocument,t?"/coteries/api/coteriedocuments/byslug/"+e:"/file_viewer/api/documents/byslug/"+e)).then(function(e){n.setState({document:e.data}),console.log(e.data),PDFJS.workerSrc="/static/pdfjs/pdf.worker.js";var t=n;PDFJS.getDocument(e.data.url).then(function(e){t.pdfDoc=e,t.setState({numPages:e.numPages}),t.setState({loading:!1}),t.renderAnnotationAreas(e.numPages),t.configSizeAccordingToLastPageAndRenderTheFirstSeveralPages(e)}),window.addEventListener("scroll",n.handleScroll,{passive:!0})})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll),this.changeToViewMode()}},{key:"render",value:function(){var e=this,t=this.state.selectedAnnotation;function n(e,t){var n=e.touches.item(0).pageX,a=e.touches.item(0).pageY,r=document.getElementById("page-div-"+t);return[n-r.offsetLeft,a-r.offsetTop]}function a(e){var t;t=null===e.touches.item(0)?e.target:e.touches.item(0).target;var n=document.getElementById("annotation-being-created");return!(null===n||n!==t&&!n.contains(t))}var r=g.a.createElement("div",{ref:function(t){return e.viewerWrappper=t},className:"viewer-wrapper"},nr(this.state.numPages).map(function(t){var r=t+1;return g.a.createElement("div",{className:"page-div",key:r,id:"page-div-"+r,style:{position:"relative",width:e.state.sampleWidth,height:e.state.sampleHeight},onTouchStart:function(t){if("view"!==e.state.mode&&!a(t)&&void 0===e.state.creatingAnnotationAtPageIndex){e.annotationFirstTouch=!0;var o=n(t,r),i=Object(Ea.a)(o,2),s=i[0],l=i[1];e.setState({creatingAnnotationAtPageIndex:r,originalAnnotationX:s,originalAnnotationY:l,newAnnotationX:s,newAnnotationY:l,newAnnotationWidth:0,newAnnotationHeight:0})}},onTouchMove:function(t){if("view"!==e.state.mode&&!a(t)&&e.annotationFirstTouch){var o=n(t,r),i=Object(Ea.a)(o,2),s=i[0],l=i[1],c=s>e.state.originalAnnotationX?e.state.originalAnnotationX:s;c=Math.max(.01,c);var u=l>e.state.originalAnnotationY?e.state.originalAnnotationY:l;u=Math.max(.01,u);var d=Math.abs(s-e.state.originalAnnotationX);d=s<e.state.originalAnnotationX?Math.min(d,e.state.originalAnnotationX):Math.min(d,e.state.sampleWidth-c);var A=Math.abs(l-e.state.originalAnnotationY);A=l<e.state.originalAnnotationY?Math.min(A,e.state.originalAnnotationY):Math.min(A,e.state.sampleHeight-u),e.setState({newAnnotationWidth:d,newAnnotationHeight:A}),e.rnd.updatePosition({x:c,y:u})}},onTouchEnd:function(t){if("view"!==e.state.mode&&!a(t))return e.setState({newAnnotationX:e.rnd.draggable.state.x,newAnnotationY:e.rnd.draggable.state.y,newAnnotationWidth:e.rnd.props.size.width,newAnnotationHeight:e.rnd.props.size.height}),e.annotationFirstTouch?(e.annotationFirstTouch=!1,void e.setState({newAnnotationInputOpen:!0})):void 0}},g.a.createElement("canvas",{style:{position:"absolute"},className:"page-canvas",id:"page-canvas-"+(t+1)}),e.state.creatingAnnotationAtPageIndex===r?g.a.createElement(Yr.a,{ref:function(t){e.rnd=t},bounds:"parent",size:{width:e.state.newAnnotationWidth,height:e.state.newAnnotationHeight},id:"annotation-being-created",className:"annotation-area",onDragStop:function(t,n){e.setState({newAnnotationX:n.x,newAnnotationY:n.y})},onResizeStop:function(t,n,a,r,o){n=n.toLowerCase(),e.setState({newAnnotationWidth:parseFloat(a.style.width),newAnnotationHeight:parseFloat(a.style.height),newAnnotationX:o.x-(n.includes("left")?r.width:0),newAnnotationY:o.y-(n.includes("top")?r.height:0)})}}):null,void 0!==e.state.annotationsByPage[r]?e.state.annotationsByPage[r].map(function(t){return g.a.createElement(Ur.a,{key:t.pk,moveThreshold:10,onTap:function(){"comment"!==e.state.mode&&e.selectAnnotation(t.uuid)}},g.a.createElement("div",{className:"annotation-area",style:{background:t.frame_color,position:"absolute",width:e.state.sampleWidth*t.width_percent,height:e.state.sampleHeight*t.height_percent,left:e.state.sampleWidth*t.left_percent,top:e.state.sampleHeight*t.top_percent},ref:function(n){return e.annotationAreas[t.uuid]=n},"annotation-id":t.pk,"annotation-uuid":t.uuid}))}):null)}));return g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",onClick:function(){e.props.history&&e.props.history.length<2?e.props.history.push("/explore"):e.props.history.goBack()}}),rightContent:[g.a.createElement(kt.a,{key:"1",type:"ellipsis"})],style:{boxShadow:"0px 1px 3px rgba(28, 28, 28, .1)",zIndex:1e7,position:"relative"}},g.a.createElement("span",{className:"document-title"},this.state.document.title)),g.a.createElement(er.a,{toast:!0,animating:this.state.loading}),g.a.createElement(Ur.a,{moveThreshold:10,onTap:function(t){"comment"!==e.state.mode&&(t.target.classList.contains("page-canvas")&&e.deselectAnnotation(),e.setState({showFloatButton:!e.state.showFloatButton}))}},r),g.a.createElement(Sr.a,{anchor:"bottom",open:this.state.annotationOpen,onClose:function(){return e.deselectAnnotation()},variant:"persistent"},g.a.createElement("div",null,g.a.createElement("div",null,g.a.createElement(zr.a,{component:"span",style:{left:8,padding:6},disabled:void 0===rr(this.state.selectedAnnotation,this.state.annotationsByPage),onClick:function(t){var n=rr(e.state.selectedAnnotation,e.state.annotationsByPage);e.selectAnnotation(n.uuid),e.annotationAreas[n.uuid].scrollIntoView({block:"start",behavior:"smooth"})}},g.a.createElement(Tr.a,null)),g.a.createElement(zr.a,{component:"span",style:{position:"absolute",right:"12vw",padding:6}},g.a.createElement(Lr.a,null)),g.a.createElement(zr.a,{component:"span",style:{position:"absolute",right:8,padding:6},disabled:void 0===or(this.state.selectedAnnotation,this.state.annotationsByPage,this.state.numPages),onClick:function(t){var n=or(e.state.selectedAnnotation,e.state.annotationsByPage,e.state.numPages);e.selectAnnotation(n.uuid),e.annotationAreas[n.uuid].scrollIntoView({block:"start",behavior:"smooth"})}},g.a.createElement(Pr.a,null))),g.a.createElement("div",{ref:function(t){return e.annotationWrapper=t}},void 0!==t?g.a.createElement(Ir,{document:this.state.document,selectedAnnotation:t,annotationArea:this.annotationAreas[t.uuid],annotations:this.state.annotations,annotationsByPage:this.state.annotationsByPage,setParentState:this.setState.bind(this),pdfDocument:this.state.document}):null))),g.a.createElement(Sr.a,{anchor:"bottom",variant:"persistent",open:this.state.newAnnotationInputOpen},g.a.createElement("div",{style:{textAlign:"center"}},g.a.createElement(St.a,{alt:"User Portrait",style:{float:"left",marginTop:"2%",marginLeft:"2%"},src:this.props.user.portrait_url}),g.a.createElement(Dt.MuiThemeProvider,{theme:Object(Dt.createMuiTheme)({palette:{primary:{main:"#3498db"}}})},g.a.createElement(Zn.a,{id:"standard-bare",placeholder:"Type in your comment...",margin:"normal",style:{width:"66vw",top:-2},multiline:!0,fullWidth:!0,value:this.state.newAnnotationContent,onChange:function(t){e.setState({newAnnotationContent:t.target.value})}})),0===this.state.newAnnotationContent.length?g.a.createElement(xt.a,{icon:["fas","times-circle"],id:"cancel-annotation-btn",onClick:this.cancelCurrentAnnotation}):g.a.createElement(xt.a,{icon:["fas","paper-plane"],id:"post-annotation-btn",onClick:this.postAnnotation}))),g.a.createElement(Sr.a,{anchor:"bottom",open:this.state.annotationLinearLinkedListOpen,onClose:function(){return e.reopenAnnotationThread()},variant:"persistent"},g.a.createElement("div",{style:{textAlign:"center"}},g.a.createElement(St.a,{alt:"User Portrait",style:{float:"left",marginTop:"2%",marginLeft:"2%"},src:this.props.user.portrait_url}),g.a.createElement(Dt.MuiThemeProvider,{theme:Object(Dt.createMuiTheme)({palette:{primary:{main:"#3498db"}}})},g.a.createElement(Zn.a,{ref:function(t){return e.annotationReplyText=t},placeholder:"Type in your reply...",margin:"normal",style:{width:"66vw",top:-2},multiline:!0,fullWidth:!0,value:this.state.newAnnotationReplyContent,onChange:function(t){e.setState({newAnnotationReplyContent:t.target.value})}})),0===this.state.newAnnotationReplyContent.length?g.a.createElement(xt.a,{icon:["fas","times-circle"],className:"cancel-comment-btn",onClick:this.cancelCurrentAnnotationReply}):g.a.createElement(xt.a,{icon:["fas","paper-plane"],className:"commit-comment-btn",onClick:this.postAnnotationReply}))),g.a.createElement(Sr.a,{anchor:"bottom",open:this.state.editCommentOpen,onClose:function(){return e.reopenAnnotationThread()},variant:"persistent"},g.a.createElement("div",{style:{textAlign:"center"}},g.a.createElement(St.a,{alt:"User Portrait",style:{float:"left",marginTop:"2%",marginLeft:"2%"},src:this.props.user.portrait_url}),g.a.createElement(Dt.MuiThemeProvider,{theme:Object(Dt.createMuiTheme)({palette:{primary:{main:"#3498db"}}})},g.a.createElement(Zn.a,{ref:function(t){return e.editText=t},placeholder:"Type in your edit...",margin:"normal",style:{width:"66vw",top:-2},multiline:!0,fullWidth:!0,value:this.state.editTextContent,onChange:function(t){e.setState({editTextContent:t.target.value})}})),0===this.state.editTextContent.length?g.a.createElement(xt.a,{icon:["fas","times-circle"],className:"cancel-comment-btn",onClick:this.cancelEdit}):g.a.createElement(xt.a,{icon:["fas","paper-plane"],className:"commit-comment-btn",onClick:this.postEdit}))),"view"===this.state.mode?g.a.createElement(Mr,{color:"rgb(27, 163, 156)",icon:g.a.createElement(sr.a,{style:{color:"white"}}),show:this.state.showFloatButton,clickCallback:this.changeToCommentMode}):g.a.createElement(Mr,{color:"#108ee9",icon:g.a.createElement(Dr.a,{style:{color:"white"}}),show:!0,clickCallback:this.changeToViewMode}))}}]),t}(g.a.Component);var Kr=Object(E.b)(function(e){return{user:e.user,coteries:e.coteries}},a)(Vr),Zr=n(114),qr=n.n(Zr),$r=n(287),eo=n.n($r),to=n(285),no=n.n(to),ao=n(286),ro=n.n(ao),oo=n(289),io=n.n(oo),so=n(288),lo=n.n(so),co=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={collected:!1,loading:!0},n.onCollectIconClick=function(){var e=n.props.readlists.readlist;if(n.state.isOwner)Qt.a.fail("You are the owner of this readlist");else{var t=new FormData;t.append("csrfmiddlewaretoken",Pt("csrftoken")),n.state.collected?(console.log("uncollectin"),n.props.uncollectReadlist(t,e.slug).then(function(){n.setState({collected:!1}),console.log("uncollected")})):(console.log("collectin"),n.props.collectReadlist(t,e.slug).then(function(){n.setState({collected:!0}),console.log("collected")}))}},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.slug;(function(){var n=Object(Zt.a)(Kt.a.mark(function n(){var a,r;return Kt.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.props.getReadlist(t);case 3:return n.next=5,e.props.getUser();case 5:return n.next=7,e.props.getMyReadlists();case 7:n.next=13;break;case 9:return n.prev=9,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return");case 13:a=e.props.user.collectedReadlists.includes(e.props.readlists.readlist.slug),r=e.props.user.pk==e.props.readlists.readlist.owner.pk,console.log(e.props.user),e.setState({collected:a,isOwner:r,loading:!1});case 17:case"end":return n.stop()}},n,this,[[0,9]])}));return function(){return n.apply(this,arguments)}})()()}},{key:"onShareIconClick",value:function(){Nt(window.location),Qt.a.success("Copied to clipboard!",1)}},{key:"renderDocumentList",value:function(){var e=this,t=this.props.readlists.readlist.documents.map(function(t){return g.a.createElement(wt.a.Item,{key:t.slug,arrow:"horizontal",thumb:g.a.createElement("img",{src:ta.a,alt:"pdf-icon",style:{height:28,width:24}}),multipleLine:!0,onClick:function(){e.props.history.push("/documents/".concat(t.slug))}},t.title,g.a.createElement(wt.a.Item.Brief,null,$n()(t.upload_time).format("MMMM Do YYYY, h:mm a")))});return g.a.createElement("div",null,g.a.createElement(Gt.a,null),g.a.createElement(wt.a,null,t))}},{key:"renderReadlistCard",value:function(){var e=this,t=this.props.readlists.readlist,n=this.state.isOwner;return g.a.createElement(qr.a,{style:{margin:"15px 15px 5px 15px"}},g.a.createElement(no.a,null,g.a.createElement(ro.a,{style:{paddingTop:"0",paddingRight:"0"},action:n?g.a.createElement(zr.a,null,g.a.createElement(wa.a,{onClick:function(){e.props.history.push("/edit-readlist-form/"+e.props.readlists.readlist.slug)}})):g.a.createElement("div",null)}),g.a.createElement("div",{style:{textAlign:"center"}},g.a.createElement(yr.a,{variant:"h5",component:"h5"},t.name),g.a.createElement(yr.a,{variant:"subtitle1",style:{whiteSpace:"pre-wrap",wordBreak:"break-all",hyphens:"auto",fontSize:12,marginTop:12}},t.description),g.a.createElement("br",null),g.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},g.a.createElement(St.a,{alt:t.owner.nickname,src:t.owner.portrait_url,style:{width:28,height:28}}),g.a.createElement(yr.a,{variant:"subtitle2",color:"textSecondary",style:{paddingLeft:5}},t.owner.nickname," created ",g.a.createElement(tn.a,{date:t.create_time}))))),g.a.createElement(eo.a,null,g.a.createElement(zr.a,{"aria-label":"Add to favorites"},this.state.collected?g.a.createElement(lo.a,{onClick:this.onCollectIconClick}):g.a.createElement(io.a,{onClick:this.onCollectIconClick})),g.a.createElement(zr.a,{"aria-label":"Share"},g.a.createElement(Vn.a,{onClick:this.onShareIconClick}))))}},{key:"render",value:function(){var e=this;return this.state.loading?g.a.createElement("div",null,g.a.createElement(Ht,{title:"Readlists",history:this.props.history,match:this.props.match}),g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5})):g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",history:this.props.history,icon:g.a.createElement(kt.a,{type:"left",onClick:function(){return e.props.history.goBack()}}),style:{boxShadow:"0px 1px 3px rgba(28, 28, 28, .1)",zIndex:1e7,position:"relative"}},g.a.createElement("span",{className:"document-title"},"Readlists")),this.renderReadlistCard(),this.renderDocumentList())}}]),t}(f.Component);var uo=Object(E.b)(function(e){return{readlists:e.readlists,user:e.user}},a)(co),Ao=n(290),po=n.n(Ao),mo=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){return function(){console.log(n.state);var t=n.state.readlists;t[e].checked=!t[e].checked,t[e].checked?t[e].count++:t[e].count--,n.setState({readlists:t})}},n.handleSubmit=function(){var e=n.state,t=e.currDocument,a=e.readlists,r=a.filter(function(e){return e.checked}).map(function(e){return e.uuid}),o=a.filter(function(e){return!e.checked}).map(function(e){return e.uuid}),i=new FormData;i.append("csrfmiddlewaretoken",Pt("csrftoken"));for(var s=0;s<r.length;s++)i.append("add_readlists[]",r[s]);for(var l=0;l<o.length;l++)i.append("remove_readlists[]",o[l]);n.props.documentChangeReadlists(t.pk,i),n.props.history.goBack()},n.state={loading:!0,currDocument:{},readlists:[]},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.groupUuid;(function(){var n=Object(Zt.a)(Kt.a.mark(function n(){var a,r,o;return Kt.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!t){n.next=4;break}n.next=8;break;case 4:return n.next=6,e.props.getMyDocuments();case 6:return n.next=8,e.props.getMyReadlists();case 8:n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(0),console.error(n.t0),n.abrupt("return");case 14:a=e.props.documents[window.location.href.split("/").pop()],r=a.uuid.replace(/-/g,""),o=e.props.user.createdReadlists.map(function(t){var n=e.props.readlists[t];return{uuid:n.uuid,name:n.name,count:n.documents_uuids.length,checked:n.documents_uuids.includes(r)}}),e.setState({currDocument:a,loading:!1,readlists:o});case 18:case"end":return n.stop()}},n,this,[[0,10]])}));return function(){return n.apply(this,arguments)}})()()}},{key:"renderOwnedReadlists",value:function(){var e=this;if(y.a.isEmpty(this.state.readlists))return g.a.createElement("div",null);var t=this.state.readlists.map(function(t,n){return g.a.createElement("div",{key:t.uuid},g.a.createElement(wt.a.Item,{thumb:g.a.createElement(po.a,{color:"primary",checked:t.checked,onChange:e.handleChange(n)}),multipleLine:!0},t.name,g.a.createElement(wt.a.Item.Brief,null,t.count+" Document(s)")))});return g.a.createElement("div",null,g.a.createElement(wt.a,null,t,g.a.createElement(wt.a.Item,null,g.a.createElement(vt.a,{type:"primary",style:{backgroundColor:"#1BA39C"},onClick:function(){return e.handleSubmit()}},"OK"))))}},{key:"render",value:function(){var e=this;return this.state.loading?g.a.createElement("div",null,g.a.createElement(Ht,{title:"Add To Readlist",history:this.props.history,match:this.props.match}),g.a.createElement($t.a,{style:{color:"#1BA39C",marginTop:"38vh"},size:"10vw",thickness:5})):g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",onClick:function(){return e.props.history.goBack()}}),style:{boxShadow:"0px 1px 3px rgba(28, 28, 28, .1)",zIndex:1e7,position:"relative"}},g.a.createElement("span",{className:"document-title"},"Add To Readlist")),g.a.createElement(dn.StickyContainer,null,g.a.createElement(Gt.a,null),g.a.createElement("div",{style:{justifyContent:"center",height:"100%"}},this.renderOwnedReadlists(this.props.user.createdReadlists))),g.a.createElement(Gt.a,null))}}]),t}(g.a.Component);var ho=Object(E.b)(function(e){return{readlists:e.readlists,documents:e.documents,user:e.user}},a)(mo),fo=(n(177),n(104));Ft.b.add(fo.a,fo.b,Bt.m,Bt.l);var go=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={},n.signOff=function(){var e=new FormData;e.append("csrfmiddlewaretoken",Pt("csrftoken")),n.props.signOff(e).then(function(e){n.props.getUser(),n.props.history.goBack()}).catch(function(e){return console.log(e)})},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){}},{key:"renderNavBar",value:function(){var e=this;return g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",onClick:function(){return e.props.history.goBack()}}),style:{boxShadow:"0px 1px 3px rgba(28, 28, 28, .1)",zIndex:1e7,position:"relative"}},g.a.createElement("span",null,"Profile"))}},{key:"render",value:function(){var e=this;return this.props.user?(console.log(this.props.user),g.a.createElement("div",null,this.renderNavBar(),g.a.createElement(Gt.a,null),g.a.createElement(wt.a,null,g.a.createElement(wt.a.Item,{extra:g.a.createElement("img",{src:this.props.user.portrait_url,alt:"img",style:{borderRadius:"50%"}})},"Portrait"),g.a.createElement(wt.a.Item,{extra:this.props.user.nickname},"Nickname"),g.a.createElement(wt.a.Item,null,"Email",g.a.createElement(wt.a.Item.Brief,{style:{textAlign:"right"}},this.props.user.email_address))),g.a.createElement(vt.a,{type:"primary",style:{backgroundColor:"#1BA39C",marginTop:28},onClick:function(){return e.signOff()}},"Log out"))):g.a.createElement("div",null,this.renderNavBar(),"You are not signed in!")}}]),t}(g.a.Component);var vo=Object(E.b)(function(e){return{user:e.user}},a)(go),yo=n(291),Eo=n.n(yo),Co=n(112),ko=n.n(Co),bo=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).onChange=function(e){e.preventDefault();var t=e.target.value,a=n.props.match.params.groupUuid;if(n.setState({searchTerm:t}),""!==t){if(a)return void n.props.getCoterieSearchResults(t,a);n.props.getSearchResults(t)}},n.state={loading:!1,searchTerm:""},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.props.getMyCoteries()}},{key:"renderSearchResultList",value:function(e){var t=this;if(!e||""===this.state.searchTerm)return g.a.createElement("div",null);var n=this.props.match.params.groupUuid,a=[],r="/documents/";if(n&&(r="/group-documents/"),e.documents){var o=e.documents.map(function(e){return{sortKey:e.title,jsx:g.a.createElement(wt.a.Item,{key:e.slug,arrow:"horizontal",thumb:"https://cdn1.iconfinder.com/data/icons/file-types-23/48/PDF-128.png",multipleLine:!0,onClick:function(){t.props.history.push(r+"".concat(e.slug))}},e.title,g.a.createElement(wt.a.Item.Brief,null,"Uploaded by ",e.uploader_name,", ",g.a.createElement(tn.a,{date:e.upload_time})))}});a=a.concat(o)}if(e.readlists){var i=e.readlists.map(function(e){return{sortKey:e.name,jsx:g.a.createElement(wt.a.Item,{key:e.slug,arrow:"horizontal",thumb:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678072-folder-document-512.png",multipleLine:!0,onClick:function(){t.props.history.push("readlists/".concat(e.slug))}},e.name,g.a.createElement(wt.a.Item.Brief,null,"Created by ",e.owner.nickname,", ",g.a.createElement(tn.a,{date:e.create_time})))}});a=a.concat(i)}if(e.users){var s=e.users.map(function(e){return{sortKey:e.nickname,jsx:g.a.createElement(wt.a.Item,{key:e.pk,arrow:"horizontal",thumb:e.portrait_url,multipleLine:!0,onClick:function(){console.log("user with pk "+e.pk+" clicked")}},e.nickname,g.a.createElement(wt.a.Item.Brief,null,e.email_address))}});a=a.concat(s)}return a=a.sort(function(e,t){return(""+e.sortKey).localeCompare(t.sortKey)}).map(function(e){return e.jsx}),g.a.createElement("div",null,g.a.createElement(wt.a,null,a))}},{key:"render",value:function(){var e=this,t="Search globally..";return this.props.match.params.groupUuid&&this.props.coteries[this.props.match.params.groupUuid]&&(t="Search within "+this.props.coteries[this.props.match.params.groupUuid].name),g.a.createElement("div",null,g.a.createElement(ft.a,{mode:"light",icon:g.a.createElement(kt.a,{type:"left",onClick:function(){return e.props.history.goBack()}}),style:{boxShadow:"0px 1px 3px rgba(28, 28, 28, .1)",zIndex:1e7,position:"relative"}},g.a.createElement("span",{className:"document-title"},g.a.createElement(Eo.a,null,g.a.createElement(ko.a,{placeholder:t,autoFocus:!0,value:this.state.searchTerm||"",onChange:this.onChange,fullWidth:!0})))),g.a.createElement(Gt.a,null),g.a.createElement(dn.StickyContainer,null,g.a.createElement("div",{style:{justifyContent:"center",height:"100%"}},this.renderSearchResultList(this.props.search))),g.a.createElement(Gt.a,null))}}]),t}(g.a.Component);var wo=Object(E.b)(function(e){return{search:e.search,coteries:e.coteries}},a)(bo);n(622);Ft.b.add(fo.a,fo.b,Bt.m,Bt.l,Bt.j);var Io=function(e){function t(e){var n;Object(d.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={isAuthenticated:!1,username:"",password:"",token:"",errorMessage:!1};var a=Object(tr.a)(Object(tr.a)(n));return n.clickLogin=function(){var e=new FormData;e.append("email_address",this.state.username),e.append("password",this.state.password),e.append("csrfmiddlewaretoken",Pt("csrftoken")),k.a.post("/api/signin",e).then(function(e){200===e.status&&(a.props.history.push("/uploads"),a.props.getUser())}).catch(function(e){console.log(e),a.setState({errorMessage:!0}),Qt.a.offline("Email or password incorrect",1.8)})},n.facebookLogin=function(){FB.login(function(e){var t=new FormData;t.append("csrfmiddlewaretoken",Pt("csrftoken")),t.append("auth_response",JSON.stringify(e.authResponse)),k.a.post("/api/signin/facebook",t).then(function(e){a.props.getUser(),window.location.href="/"}).catch(function(e){Qt.a.offline("Facebook login unsuccessful",1.8)})},{scope:"email"})},n.nusLogin=function(){var e="https://"+window.location.host;window.location.href="https://ivle.nus.edu.sg/api/login/?apikey=Z6Q2MnpaPX8sDSOfHTAnN&url="+e+"/api/signin/nus"},n.handleMessageClose=function(e,t){"clickaway"!==t&&n.setState({errorMessage:!1})},n}return Object(h.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;!function(e,t,n){var a,r=e.getElementsByTagName(t)[0];e.getElementById(n)||((a=e.createElement(t)).id=n,a.src="https://connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(a,r))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){FB.init({appId:"213151942857648",cookie:!0,xfbml:!0,version:"v3.0"}),FB.AppEvents.logPageView(),e.setState({fbLoginButtonLoading:!1})};var t=void 0;gapi.load("auth2",function(){var n;t=gapi.auth2.init({client_id:"887521980338-fj0n0r7ui5cn313f4vh6paqm411upf3o.apps.googleusercontent.com",cookiepolicy:"single_host_origin"}),n=document.getElementById("google-button"),t.attachClickHandler(n,{},function(t){var n=new FormData;n.append("csrfmiddlewaretoken",Pt("csrftoken")),n.append("id_token",t.getAuthResponse().id_token),k.a.post("/api/signin/google",n).then(function(t){e.props.getUser(),window.location.href="/"}).catch(function(e){console.log(e.response),Qt.a.offline("Google login unsuccessful",1.8)})},function(e){console.log(JSON.stringify(e,void 0,2)),Qt.a.offline("Google login unsuccessful",1.8)})})}},{key:"render",value:function(){var e=this;return g.a.createElement("div",null,g.a.createElement(qr.a,{id:"login-card"},g.a.createElement("div",{className:"social",id:"logo-div"},g.a.createElement("img",{id:"logo",src:hn.a})),g.a.createElement("div",{className:"social"},g.a.createElement(gn.a,{variant:"contained",size:"small",id:"google-button",className:"social-button"},g.a.createElement(xt.a,{icon:["fab","google"],className:"social-icon"}),g.a.createElement("span",{className:"social-text"},"Log in with Google"))),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement("div",{className:"social"},g.a.createElement(gn.a,{variant:"contained",color:"primary",size:"small",id:"facebook-button",className:"social-button",onClick:this.facebookLogin},g.a.createElement(xt.a,{icon:["fab","facebook"],className:"social-icon"}),g.a.createElement("span",{className:"social-text"},"Log in with Facebook"))),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement("div",{className:"social"},g.a.createElement(gn.a,{variant:"contained",size:"small",id:"nus-button",className:"social-button",onClick:this.nusLogin},g.a.createElement(xt.a,{icon:"university",className:"social-icon"}),g.a.createElement("span",{className:"social-text"},"Log in with NUS ID"))),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement("div",{style:{textAlign:"center"}},g.a.createElement(Zn.a,{className:"input-width",label:"Email Address",value:this.state.username,onChange:function(t){e.setState({username:t.target.value})}}),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement(Zn.a,{className:"input-width",type:"password",label:"Password",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}})),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement("div",{className:"social"},g.a.createElement(gn.a,{onClick:function(t){return e.clickLogin()},variant:"outlined",color:"primary",size:"small",className:"social-button"},g.a.createElement(kt.a,{type:"check-circle-o",id:"submit-icon",style:{color:"#1BA39C",marginRight:8}}),g.a.createElement("span",{className:"login-text",style:{color:"#1BA39C"}},"Log in"))),g.a.createElement(Gt.a,{size:"lg"}),g.a.createElement("div",{className:"social"},g.a.createElement(gn.a,{color:"primary",size:"small",className:"social-butto"},g.a.createElement("span",{className:"login-text",style:{color:"#1BA39C"}},"Create an Account ",g.a.createElement("br",null),"(Coming soon)")))))}}]),t}(g.a.Component);var Bo=Object(E.b)(function(e){return{user:e.user}},a)(Io),Do=n(292),Oo=n.n(Do),So=n(293),xo=Object(u.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:var n=t.payload.data;return y.a.extend({},n);case w:return{};case I:var a=t.payload.data.uploadedDocuments,r=t.payload.data.collectedDocuments;return y.a.extend({},e,{uploadedDocuments:y.a.map(a,"slug"),collectedDocuments:y.a.map(r,"slug")});case B:var o=t.payload.data;return y.a.extend({},e,{uploadedDocuments:y.a.map(o,"slug"),collectedDocuments:[]});case O:case $:var i=y.a.concat(e.uploadedDocuments,t.payload.data.slug);return y.a.extend({},e,{uploadedDocuments:i});case x:var s=y.a.filter(e.uploadedDocuments,function(e){return e!==t.payload}),l=y.a.filter(e.collectedDocuments,function(e){return e!==t.payload});return y.a.extend({},e,{uploadedDocuments:s,collectedDocuments:l});case j:var c=y.a.filter(e.collectedDocuments,function(e){return e!==t.payload});return y.a.extend({},e,{collectedDocuments:c});case J:var u=t.payload.data.joinedCoteries,d=t.payload.data.administratedCoteries;return y.a.extend({},e,{joinedCoteries:y.a.map(u,"uuid"),administratedCoteries:y.a.map(d,"uuid")});case ee:var A=y.a.filter(e.joinedCoteries,function(e){return e!==t.uuid});return y.a.extend({},e,{joinedCoteries:A});case te:var p=y.a.filter(e.administratedCoteries,function(e){return e!==t.uuid});return y.a.extend({},e,{administratedCoteries:p});case R:var m=t.payload.data.created_readlists,h=t.payload.data.collected_readlists;return y.a.extend({},e,{createdReadlists:y.a.map(m,"slug"),collectedReadlists:y.a.map(h,"slug")});default:return e}},documents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return{};case I:var n=t.payload.data.uploadedDocuments,a=t.payload.data.collectedDocuments;return y.a.extend(y.a.extend({},e,y.a.keyBy(n,"slug")),y.a.keyBy(a,"slug"));case B:var r=t.payload.data;return y.a.extend({},e,y.a.keyBy(r,"slug"));case O:case $:var o=t.payload.data;return y.a.extend({},e,Object(It.a)({},o.slug,o));case S:var i=t.payload.data;return y.a.extend({},e,Object(It.a)({},i.slug,i));case x:return y.a.omit(e,t.payload);default:return e}},coteries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return{};case J:var n=t.payload.data.joinedCoteries,a=t.payload.data.administratedCoteries;return y.a.extend(y.a.extend({},e,y.a.keyBy(n,"uuid")),y.a.keyBy(a,"uuid"));case X:var r=t.payload.data;return y.a.extend({},e,Object(It.a)({},r.uuid,r));case te:return y.a.omit(e,t.uuid);case K:var o=e[t.payload.uuid];return t.payload.name&&(o.name=t.payload.name),t.payload.description&&(o.description=t.payload.description),y.a.extend({},e,Object(It.a)({},t.payload.uuid,o));case q:console.log(t);var i=e[t.payload.uuid];return i.members=i.members.filter(function(e){return e.email_address!==t.payload.email}),y.a.extend({},e,Object(It.a)({},i.uuid,i));default:return e}},readlists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:var n=t.payload.data;return y.a.extend({},e,{readlist:n});case R:var a=t.payload.data.created_readlists,r=t.payload.data.collected_readlists;return y.a.extend(y.a.extend({},e,y.a.keyBy(a,"slug")),y.a.keyBy(r,"slug"));default:return e}},explore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:var n=t.payload.data.filter(function(e){return"most_views"===e.description}),a=t.payload.data.filter(function(e){return"most_collectors"===e.description}),r=t.payload.data.filter(function(e){return"most_annotations"===e.description});return y.a.extend({},e,{documents:{mostViewsDocuments:n,mostStarsDocuments:a,mostAnnotationsDocuments:r}});case M:var o=t.payload.data.most_collectors_readlists,i=t.payload.data.newest_readlists;return y.a.extend({},e,{readlists:{mostCollectorsReadlists:o,newestReadlists:i}});default:return e}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return{};case F:var n=t.payload.data;return y.a.extend({},e,y.a.keyBy(n,"slug"));case U:var a=e[t.slug];return a.unread=!1,y.a.extend({},e,Object(It.a)({},a.slug,a));case H:var r=y.a.filter(e,function(e){return t.payload.unreadNotificationSlug.includes(e.slug)});return r=y.a.map(r,function(e){return e.unread=!1,e}),y.a.extend({},e,y.a.keyBy(r,"slug"));default:return e}},invitations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return{};case ne:var n=t.payload.data;return y.a.extend({},e,y.a.keyBy(n,"pk"));case ae:case re:return y.a.omit(e,t.pk);default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:var n=t.payload.data.resultReadlists,a=t.payload.data.resultDocuments,r=t.payload.data.resultUsers;return y.a.extend({},e,{readlists:n,documents:a,users:r});case W:return{};default:return e}}}),jo=Object(Dt.createMuiTheme)({typography:{useNextVariants:!0,suppressDeprecationWarnings:!0},palette:{primary:{main:"#1BA39C"}}}),Ro=Object(u.e)(xo,Object(u.d)(Object(u.a)(Oo.a,So.a)));gr.a.render(g.a.createElement(Dt.MuiThemeProvider,{theme:jo},g.a.createElement(E.a,{store:Ro},g.a.createElement(Ua,null,g.a.createElement(i.a,null,g.a.createElement(s.a,null,g.a.createElement(l.a,{path:"/documents/:slug",render:function(e){return function(e,t,n){return g.a.createElement(Kr,{isGroupDocument:!1,match:e,location:t,history:n})}(e.match,e.location,e.history)}}),g.a.createElement(l.a,{path:"/coteries/:coterieId/documents/:slug",render:function(e){return function(e,t,n){return g.a.createElement(Kr,{isGroupDocument:!0,match:e,location:t,history:n})}(e.match,e.location,e.history)}}),g.a.createElement(l.a,{path:"/readlists/:slug",component:uo}),g.a.createElement(l.a,{path:"/search/:groupUuid",component:wo}),g.a.createElement(l.a,{path:"/search",component:wo}),g.a.createElement(l.a,{path:"/profile",component:vo}),g.a.createElement(l.a,{path:"/add-to-readlists",component:ho}),g.a.createElement(l.a,{path:"/create-coterie-form",component:Xa}),g.a.createElement(l.a,{path:"/create-readlist-form",component:Ka}),g.a.createElement(l.a,{path:"/edit-readlist-form/:slug",component:qa}),g.a.createElement(l.a,{path:"/sign-in",component:Bo}),g.a.createElement(l.a,{exact:!0,path:"/",render:function(){return g.a.createElement(c.a,{to:"/uploads"})}}),g.a.createElement(l.a,{path:"/groups/:groupUuid?/",component:Ya}),g.a.createElement(l.a,{path:"/",component:Ya})))))),document.getElementById("root")),function(e){if("serviceWorker"in navigator&&!r){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){r?(function(e,t){fetch(e).then(function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):o(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}("/sw",e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):o("/sw",e)})}}({})},72:function(e,t,n){e.exports=n.p+"static/media/logo.1f3294f6.svg"}},[[297,2,1]]]);
//# sourceMappingURL=main.573b526a.chunk.js.map